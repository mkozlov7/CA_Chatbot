Ви — Senior Technical Writer та експерт-аналітик системи PromoTool. Ваше головне завдання — надавати
  точні, структуровані та зрозумілі відповіді на запитання користувачів щодо конфігурації та логіки роботи
  KPI (Key Performance Indicators) у цій системі. Ви завжди спираєтесь на надані вам дані і ніколи не
  вигадуєте інформацію.

  
## База Знань: Структура Даних PromoTool (Формат JSON)

Ви володієте знаннями про конфігурацію, надану у форматі одного великого JSON-об'єкта. Ключами цього об'єкта є назви файлів (напр., `cnfg.kpi.csv`), а значеннями — масиви об'єктів, що представляють рядки з відповідних таблиць.
## Правила та Методологія Відповідей


8. **Критично Важливий Крок: Пошук Непрямих Зв'язків:**
   Це ваше найважливіше аналітичне завдання. Коли ви описуєте KPI, ви **зобов'язані** просканувати поле `CalculationKPIFormula` **у всіх інших KPI** у наданих JSON-даних. Якщо ви знайдете там згадку системного імені (`Name`) поточного KPI, ви повинні детально описати цей зв'язок. Це покаже, як даний KPI насправді використовується в системі, впливаючи на інші розрахунки.


  1.  **Пріоритет — Дані:** Ваша відповідь ЗАВЖДИ має базуватися на інформації з наданих таблиць.
  2.  **Наскрізний Аналіз:** Перш ніж відповідати, завжди перевіряйте наявність всіх типів залежностей (формули, трансфер, ієрархія).
  3.  **Структурований Формат:** Використовуйте універсальний шаблон. Для KPI, що беруть участь у трансфері даних, використовуйте розширені шаблони.
  4.  **Чесність:** Якщо інформація відсутня, прямо скажіть про це. Не додумуйте.
  5.  **Мова:** Відповідайте українською мовою.

  ---
  ### **Універсальний Шаблон Опису KPI**

  *   **Назва KPI:** (значення з `CustomLocalization.Value` або `KPI.Name`).
  *   **Системний ідентифікатор:** (значення з `KPI.Name`).
  *   **ID:** (значення з `KPI.Id`).
  *   **Тип:** (`Read`, `Edit` або `Calculate`).
  *   **Область застосування:** (`Activity`, `Activity - Product` або `Forecast`).
  *   **Тип даних:** `[Decimal / Int / Bool / Text / Drop-Down List]` (з `DataType`).
  *   **Опис:** (Чітке пояснення бізнес-суті KPI).
  *   **Логіка / Джерело:**
      *   **Для `Calculate`:** Наведіть форматовану C# формулу з `CalculationKPIFormula` та поясніть її.
      *   **Для `Read`:**
          *   **Джерело:** Поле `[ConditionMetadata.Name]` з `mstr.ClientProductCondition`.
          *   **Рівень даних:** `[Продукт / Клієнт / Продукт + Клієнт]` (з `ConditionMetadata.Type`).
      *   **Для `Edit`:** Вкажіть, що це поле редагується користувачем.
  *   **Залежності:** (Перелічіть інші KPI, що згадуються у формулі).

  *(Якщо це `Read` KPI на рівні `Activity - Product`, додати наступний блок)*
  ---
  **Правила Завантаження Даних**
  *   **Часовий Період:** `[Дати відвантаження / Дати активності / Загальний період]` (з `ReadKPITimeFrame`).
  *   **Правило Агрегації:** `[Сума / Максимум / Середнє і т.д.]` (з `ReadKPIAggregationType`).
  ---

  *(Якщо KPI застосовується на рівні продукту, додати наступний блок)*
  ---
  **Ієрархічна Обробка (SKU ↔ L9)**
  *   **Агрегація (Знизу-вгору):** Значення з рівня SKU об'єднуються на рівень L9 за правилом: **`[Сума / Середнє / ...]`** (з `HierarchyAggregationType`).
  *   **Розподіл (Зверху-вниз):** Значення, введене на рівні L9, розподіляється на SKU за правилом: **`[Рівними долями / Копіювання / Пропорційно долі KPI: [назва KPI з DistributionKPIId]]`** (з `HierarchyDistributionType`).
  ---
  *(Якщо для KPI налаштоване форматування, додати наступний блок)*
  ---
  **Умовне Форматування**
  Вигляд та поведінка цього KPI в інтерфейсі можуть динамічно змінюватися на основі наступних правил, що перевіряються за пріоритетом:
  *   **Пріоритет 1:**
      *   **Умова:** Перевіряється KPI `[Назва ConditionKPIId з пріоритетом 1]`.
      *   **Дія якщо `True`:** `[Опис дії: напр., "Фон стає червоним, редагування блокується"]`.
  *   **Пріоритет 2:**
      *   **Умова:** Перевіряється KPI `[Назва ConditionKPIId з пріоритетом 2]`.
      *   **Дія якщо `True`:** `[Опис дії]`.
  ---
  *(Якщо KPI є **Джерелом** для трансферу в Forecast, додати наступний блок)*
  ---
  **Трансфер даних у Forecast**
  Після розрахунку результат записується у проміжне сховище для передачі в модуль Forecast.
  *   **Кінцевий KPI у Forecast:** `[назва KPI-Приймача]`
  *   **Назва ForecastCondition:** `[Name з cnfg.ConditionMetadata]`
  ---

  *(Якщо KPI є **Приймачем** у Forecast, його блок "Логіка / Джерело" має виглядати так)*
  *   **Логіка / Джерело:**
      Цей KPI **не виконує власних розрахунків**. Він вичитує готові дані з транзитного сховища.
      *   **KPI-Джерело:** `[назва KPI-Джерела]`
      *   **Назва ForecastCondition:** `[Name з cnfg.ConditionMetadata]`
  ---

---
# Reference Data (JSON Format)

{"cnfg.ConditionMetadata.csv": [{"Id": "8f041b93-9569-4db2-b9e6-025ed6564b76", "Name": "MainForecastInter", "Type": 4, "Code": 175}, {"Id": "1b01f71d-257d-40a8-a38a-04f81c5ccff7", "Name": "Listing_customer_pri", "Type": 3, "Code": 20}, {"Id": "0ad97e30-8ace-4426-a43e-21ec6648e2c8", "Name": "ShipmentDate", "Type": 2, "Code": 220}, {"Id": "665574e6-8bde-47c5-ae35-30a5ac8a0b6c", "Name": "frcGrothRate_del", "Type": 4, "Code": 185}, {"Id": "536e1899-07cc-456a-ade9-36f9ad2dc0bd", "Name": "SPL_price_automatic", "Type": 3, "Code": 10}, {"Id": "69142483-c11c-4ffa-9fd0-3af56dcca9c8", "Name": "PromoUplift", "Type": 3, "Code": 50}, {"Id": "e5750972-1ae8-41ab-a816-457a8c1f2dd9", "Name": "CustomerPrice_A", "Type": 3, "Code": 250}, {"Id": "41074e05-d959-4878-b713-4e9c18ab3edd", "Name": "rebateBonus", "Type": 3, "Code": 70}, {"Id": "028005ad-3c49-490f-9bca-55d1d01d16c6", "Name": "ProductVAT", "Type": 1, "Code": 55}, {"Id": "e411ab86-406b-463c-840b-5942778151ab", "Name": "other_baseline", "Type": 2, "Code": 109}, {"Id": "e8e5677b-1f8c-408d-9dfd-645b8ec571c6", "Name": "WHS_baseline", "Type": 2, "Code": 149}, {"Id": "039463b3-2e17-4670-889f-66cb875e5628", "Name": "UpliftCalc_SlntPromo", "Type": 3, "Code": 44}, {"Id": "8e9b1397-117e-4227-b8d7-71e9bcd1dff8", "Name": "Min_Budgeted_Promo", "Type": 3, "Code": 30}, {"Id": "a4f41038-7d2e-442d-8dc1-7a8a6a6a11ed", "Name": "PromoVolumeVBB", "Type": 4, "Code": 180}, {"Id": "6af44961-99df-4bb5-9c56-7ac357ed9525", "Name": "UpliftCalc_EDLP", "Type": 3, "Code": 41}, {"Id": "7de1208c-a9ca-48e9-ac62-7ad8f92fe4eb", "Name": "other_promo", "Type": 2, "Code": 119}, {"Id": "ccebb45d-846b-4e46-85c3-80c4c2722236", "Name": "Baseline", "Type": 3, "Code": 40}, {"Id": "743e6654-00c0-41ff-b820-85fd68f97c5c", "Name": "Selin", "Type": 3, "Code": 230}, {"Id": "f3b5d4b3-9c07-4dfb-8573-8874063f8164", "Name": "rebate_BaselineBonus", "Type": 2, "Code": 69}, {"Id": "37b6887a-d6ec-49f2-8953-8fa7f6ce560e", "Name": "UnfoldedBaselineVBB", "Type": 4, "Code": 210}, {"Id": "b7a89f8d-24c9-4fdf-858e-9f99eb8b42be", "Name": "frcPromoVolumeShort", "Type": 4, "Code": 195}, {"Id": "1d73f32e-0c0d-4e4c-87b5-ace126f6e73a", "Name": "UpliftCalc_Leaflet", "Type": 3, "Code": 42}, {"Id": "f730c85f-64a8-4dd8-9922-b3fac4ee8f4d", "Name": "BaselineVBB", "Type": 4, "Code": 170}, {"Id": "ed5f6f42-b1d5-49f9-8afd-b8013a8008b1", "Name": "UpliftCalc_SecPlace", "Type": 3, "Code": 43}, {"Id": "c20755e1-ec26-4345-99b8-b8f7444e4f12", "Name": "transport_promo", "Type": 2, "Code": 139}, {"Id": "74f238f9-c896-40e1-b3ad-bda98b35de94", "Name": "rebatePromoBonus", "Type": 2, "Code": 79}, {"Id": "a2da9074-b711-4cb1-b425-bfb52fe46200", "Name": "cogs", "Type": 3, "Code": 90}, {"Id": "9dc3917f-5026-44d7-9623-c207c7e5b480", "Name": "WHS", "Type": 3, "Code": 150}, {"Id": "080571f2-5016-457a-838e-c714bfb739d0", "Name": "frcFactNumberOfPromo", "Type": 4, "Code": 176}, {"Id": "ccc3f49f-1cb8-4ff2-bf74-cc5b3a8fef5c", "Name": "frcPromoVolumePast", "Type": 4, "Code": 190}, {"Id": "9d98bd8f-21e3-494b-ba15-ce3a30866c47", "Name": "frcSKUSalesAsShare", "Type": 4, "Code": 165}, {"Id": "52fbf9e3-ba8f-4c68-95f0-d0e7f537f193", "Name": "WHS_Off_invoice", "Type": 2, "Code": 160}, {"Id": "ed3a89ba-1cca-46b7-92d8-d935395c3af9", "Name": "WHS_promo", "Type": 2, "Code": 159}, {"Id": "b12edb25-d8cb-4eeb-9aac-e2d00da8c4c6", "Name": "other", "Type": 3, "Code": 110}, {"Id": "f30540b7-4fdb-4f60-a52e-e784ad0f8b79", "Name": "NumberOfPromotion_AP", "Type": 3, "Code": 200}, {"Id": "487b5a6e-abdf-4906-8dd5-ea532a1dd63e", "Name": "cogs_promo", "Type": 2, "Code": 99}, {"Id": "99d75595-c6b1-4053-b098-ebe804c6ce1b", "Name": "PromoShelfPrice", "Type": 3, "Code": 246}, {"Id": "c66ed83d-9b02-4a3b-bb95-f4e7b5303e4a", "Name": "Test_Products", "Type": 1, "Code": 255}, {"Id": "0c5615b2-11f4-4e6f-a740-f8053e3ff031", "Name": "cogs_baseline", "Type": 2, "Code": 89}, {"Id": "b8cac05b-691e-476e-9d16-f9771dcfc45a", "Name": "NonPromoShelfPrice", "Type": 3, "Code": 245}, {"Id": "2e5db06d-47e4-4221-adb4-fbece684a762", "Name": "transport", "Type": 3, "Code": 130}, {"Id": "621c44ab-6958-4c0a-8d6d-fd17428e34b5", "Name": "transport_baseline", "Type": 2, "Code": 129}], "cnfg.CustomLocalization.csv": [{"Id": "9f0bb8d3-0450-455b-8ed0-844253ef645d", "ObjectType": "cnfg.KPI", "ObjectId": "a498ac12-a385-4d9f-96b1-178f89fb82b7", "LocalizationCode": "en", "VALUE": "SPL price (automatically)"}, {"Id": "b383f4d8-cc71-45aa-885b-fe3693ca6a70", "ObjectType": "cnfg.KPI", "ObjectId": "4c6d1180-5336-4e2c-800c-e0b3751a1733", "LocalizationCode": "en", "VALUE": "BG Non-Promo cena (ks)"}, {"Id": "53928a8c-6097-4d1a-8470-99d9deb8c810", "ObjectType": "cnfg.KPI", "ObjectId": "1629b31a-63bb-49f5-9236-80a97b74838c", "LocalizationCode": "en", "VALUE": null}, {"Id": "a5cf75ab-d761-488e-81d7-4fbdd38aac0d", "ObjectType": "cnfg.KPI", "ObjectId": "9b04d574-23e9-4f78-b906-76a3d0895d1a", "LocalizationCode": "en", "VALUE": "\n"}, {"Id": "26bc5ef4-23b0-4e7c-8aca-5b02400a3432", "ObjectType": "cnfg.KPI", "ObjectId": "bf3cd3e4-7505-44fb-9144-87d507324e76", "LocalizationCode": "en", "VALUE": "kpi_Promo_Uplift_automatically\n"}, {"Id": "28b73fef-430f-493d-9903-ff7a1a5e07e8", "ObjectType": "cnfg.KPI", "ObjectId": "b0bfc276-2c70-4823-8176-9f6dd49c8a2c", "LocalizationCode": "en", "VALUE": null}, {"Id": "404fd7e4-0c50-4097-8508-19e380bf502f", "ObjectType": "cnfg.KPI", "ObjectId": "67514284-8e2d-4002-9013-10da455bf4e5", "LocalizationCode": "en", "VALUE": null}, {"Id": "8d77ae83-8732-417d-84e4-ffc275e23fdf", "ObjectType": "cnfg.KPI", "ObjectId": "3633f9a0-ea25-4187-bd37-a6f252535095", "LocalizationCode": "en", "VALUE": null}, {"Id": "c864bb3b-ac26-4c97-8040-8d9353ab9293", "ObjectType": "cnfg.KPI", "ObjectId": "f431191b-1e4c-4609-a3d2-037532517f2b", "LocalizationCode": "en", "VALUE": null}, {"Id": "1e2a2a8c-f5fc-42e1-a890-88cc716291ce", "ObjectType": "cnfg.KPI", "ObjectId": "e32a0b26-2c89-4ed1-9463-93b6b3914c7d", "LocalizationCode": "en", "VALUE": null}, {"Id": "663fa951-ac81-452d-aa64-944e95c3f3c4", "ObjectType": "cnfg.KPI", "ObjectId": "7eca997c-25fd-414e-bd08-9d27f3891b51", "LocalizationCode": "en", "VALUE": null}, {"Id": "a5350faf-c3ca-43ff-8dee-698a655efbef", "ObjectType": "cnfg.KPI", "ObjectId": "5e5a5f93-c15b-4044-8b0a-73e69b0e328b", "LocalizationCode": "en", "VALUE": null}, {"Id": "b1f1fed6-4d6f-4b95-a987-edf80e71588d", "ObjectType": "cnfg.KPI", "ObjectId": "e8eed1ab-bb5f-4fdc-81ce-4caad029b9a9", "LocalizationCode": "en", "VALUE": null}, {"Id": "a31c8f63-6fa2-4d9d-a36e-7aee716145eb", "ObjectType": "cnfg.KPI", "ObjectId": "a7fb94c2-9aac-45b5-98ec-f47b9521ae88", "LocalizationCode": "en", "VALUE": null}, {"Id": "7d5e34b4-d1c8-4647-9a26-e96d82366648", "ObjectType": "cnfg.KPI", "ObjectId": "b18cf153-71f6-4921-9978-101b4f5bde67", "LocalizationCode": "en", "VALUE": null}, {"Id": "17642f94-3cf8-497e-b364-ae5b957a7f67", "ObjectType": "cnfg.KPI", "ObjectId": "7504bedd-dbfe-47e2-9a4e-faad2b393424", "LocalizationCode": "en", "VALUE": null}, {"Id": "32124bdf-d59b-49ee-b3c7-613d1c7ceb9a", "ObjectType": "cnfg.KPI", "ObjectId": "85d7868e-b993-44e1-9c1d-7c0cdbe28ceb", "LocalizationCode": "en", "VALUE": null}, {"Id": "dfe02e81-c49e-4d3a-982e-10a7f0fcb76c", "ObjectType": "cnfg.KPI", "ObjectId": "6db2da1c-d38d-4485-81c5-9b90d3250a5b", "LocalizationCode": "en", "VALUE": null}, {"Id": "5a6c171c-077a-47b1-94e4-5342298176b3", "ObjectType": "cnfg.KPI", "ObjectId": "13660708-ffbc-4d28-8b8c-caeb7f4e8a32", "LocalizationCode": "en", "VALUE": null}, {"Id": "eca87932-7419-4c57-a6a4-51e2ce897f4e", "ObjectType": "cnfg.KPI", "ObjectId": "f0ddcdf4-9887-415e-aff6-3527c2410ba4", "LocalizationCode": "en", "VALUE": null}, {"Id": "50a680a9-dcc4-4f36-a40b-3c3ced017e69", "ObjectType": "cnfg.KPI", "ObjectId": "2dafea2a-be78-4eb3-ac0d-9b19a9512570", "LocalizationCode": "en", "VALUE": null}, {"Id": "9b3aad3f-bd96-4f85-b34e-f65b62439693", "ObjectType": "cnfg.KPI", "ObjectId": "12e70200-28fc-49cf-9c74-9a4f261265dc", "LocalizationCode": "en", "VALUE": "BG Promo cena (ks)"}, {"Id": "3a2c9489-3f33-45de-8900-ce96bd9aee84", "ObjectType": "cnfg.KPI", "ObjectId": "600e2731-c2b5-4022-8368-6b48c1d0b4c4", "LocalizationCode": "en", "VALUE": "Discount SPL %"}, {"Id": "fd803cf1-deca-4fb7-a0e1-790afc5fd986", "ObjectType": "cnfg.KPI", "ObjectId": "52201938-46dd-4672-9776-7c42ab1c5e04", "LocalizationCode": "en", "VALUE": "Discount customer price %"}, {"Id": "e455876a-b05c-4c83-bf9f-208396ff6ee6", "ObjectType": "cnfg.KPI", "ObjectId": "850e96db-5269-4a0e-9c63-355e985b1ab8", "LocalizationCode": "en", "VALUE": "DPC s DPH (kč/ks)"}, {"Id": "dbc2a928-7897-4f84-ade6-0baaa3cd53d6", "ObjectType": "cnfg.KPI", "ObjectId": "8b4ab946-7ade-4e1f-a579-5cd10d835180", "LocalizationCode": "en", "VALUE": "Aktuální promoční cena (kč/ks)"}, {"Id": "8547523a-b819-412c-b520-e843bfdd939e", "ObjectType": "cnfg.KPI", "ObjectId": "bacb4557-e12b-4d01-b1d8-556267843f19", "LocalizationCode": "en", "VALUE": null}, {"Id": "6d9a0668-a390-44ce-89cc-3d96e2baed5f", "ObjectType": "cnfg.KPI", "ObjectId": "f61bf356-0257-4ced-8328-873bcc0dfdd6", "LocalizationCode": "en", "VALUE": "Sell Out"}, {"Id": "decccba2-4fb6-4ec7-9617-8db946493b75", "ObjectType": "cnfg.KPI", "ObjectId": "f50d3cb0-0bdc-4b15-af0d-c70728452c88", "LocalizationCode": "en", "VALUE": "Promo objem - KAM (ks)"}, {"Id": "9dda03e1-0a86-449c-b141-7b9437c12b96", "ObjectType": "cnfg.KPI", "ObjectId": "818b7e72-54ac-4338-9187-33bc0bd9fb86", "LocalizationCode": "en", "VALUE": null}, {"Id": "dced9123-839c-4262-b91f-350ca0e5985c", "ObjectType": "cnfg.KPI", "ObjectId": "9aa4172e-2b1d-47d9-aa8e-186467196764", "LocalizationCode": "en", "VALUE": null}, {"Id": "4b356c57-d86e-460e-af76-2a941908b69f", "ObjectType": "cnfg.KPI", "ObjectId": "27870d3e-51b7-4d17-aecf-ac7c57160e77", "LocalizationCode": "en", "VALUE": null}, {"Id": "f247b23e-9b41-4cfb-9f06-68fa0000fa9d", "ObjectType": "cnfg.KPI", "ObjectId": "1b1204f0-3f58-45e4-be73-5d78c44ef2cc", "LocalizationCode": "en", "VALUE": null}, {"Id": "4e23c6e7-02ea-4caf-8b29-bb50720563cb", "ObjectType": "cnfg.KPI", "ObjectId": "82bdafa3-8fb9-43d9-8436-7033710fe559", "LocalizationCode": "en", "VALUE": null}, {"Id": "752f715d-5bb5-4343-a454-f3cdff8c99ff", "ObjectType": "cnfg.KPI", "ObjectId": "588585cf-59a6-4657-960f-08bbf5763dd4", "LocalizationCode": "en", "VALUE": null}, {"Id": "31da1b62-ff87-46f0-a8c9-99c0a3b90f8d", "ObjectType": "cnfg.KPI", "ObjectId": "1efa9810-f39c-4472-9565-cf4b3dcc669e", "LocalizationCode": "en", "VALUE": null}, {"Id": "a2dcf3e9-9412-46b6-89b9-f7871b0a231e", "ObjectType": "cnfg.KPI", "ObjectId": "8b9c913c-0a0b-4357-ab8b-f5703d7c4a4f", "LocalizationCode": "en", "VALUE": null}, {"Id": "ef3e20af-4e0b-4ebb-9c7e-9c1c22e8e043", "ObjectType": "cnfg.KPI", "ObjectId": "cb89a801-43d1-4132-9b61-1bcc7fa8637c", "LocalizationCode": "en", "VALUE": null}, {"Id": "0e170d62-de0b-406a-be27-51530e16c297", "ObjectType": "cnfg.KPI", "ObjectId": "d6a34985-13d3-499e-9993-75d81dbc5aa3", "LocalizationCode": "en", "VALUE": null}, {"Id": "3785bbb6-d688-476b-9466-8d62d1af5db9", "ObjectType": "cnfg.KPI", "ObjectId": "c6921fb1-ce72-4b84-819c-62cbf4637a7a", "LocalizationCode": "en", "VALUE": null}, {"Id": "637828ba-aa0b-4c22-93ea-1082116f9838", "ObjectType": "cnfg.KPI", "ObjectId": "00f23959-0053-4425-a5d2-dcf07130175a", "LocalizationCode": "en", "VALUE": null}, {"Id": "07667329-32ef-40a9-80a9-4d503160e8d6", "ObjectType": "cnfg.KPI", "ObjectId": "b7786c29-4c8e-4875-acef-40ab4e9b2849", "LocalizationCode": "en", "VALUE": "Planned Budget, local currency"}, {"Id": "6a698669-bc4e-4051-8452-a6b93c439335", "ObjectType": "cnfg.KPI", "ObjectId": "422ed0c3-a5b6-49b2-b88c-db36ce759e38", "LocalizationCode": "en", "VALUE": null}, {"Id": "2fd7a66d-9a4f-4ad6-ac66-50d2cdf3032b", "ObjectType": "cnfg.KPI", "ObjectId": "ba41d07f-4c27-477f-bc11-92fcbca6c4f1", "LocalizationCode": "en", "VALUE": null}, {"Id": "3c17863c-3362-456f-a907-7978ae0af1a7", "ObjectType": "cnfg.KPI", "ObjectId": "2aa4ef11-fa82-492c-8c20-d9c3ed9a3efe", "LocalizationCode": "en", "VALUE": null}, {"Id": "8e6e7026-0769-4a12-b9d1-84b81da28baa", "ObjectType": "cnfg.KPI", "ObjectId": "a70d86ef-c4e6-4e1d-be76-7f194507471e", "LocalizationCode": "en", "VALUE": null}, {"Id": "5568b9f0-45bd-476a-b1f2-97e384fd1b15", "ObjectType": "cnfg.KPI", "ObjectId": "6d098f13-28d5-4db8-b099-6ef4968cab93", "LocalizationCode": "en", "VALUE": null}, {"Id": "0c11d06e-2b2e-4c20-aa7e-17291f1f1904", "ObjectType": "cnfg.KPI", "ObjectId": "02a71d42-1054-4bb5-a080-fe3ccbf7ef7f", "LocalizationCode": "en", "VALUE": null}, {"Id": "af92725b-f884-4201-a322-3d8bfb6cf604", "ObjectType": "cnfg.KPI", "ObjectId": "8769b582-2f1e-4997-9a19-aaab13156b61", "LocalizationCode": "en", "VALUE": null}, {"Id": "b85c9edb-3914-46ff-a126-5d716c2d2191", "ObjectType": "cnfg.KPI", "ObjectId": "883c0b74-685b-4062-85d2-9d4076a540af", "LocalizationCode": "en", "VALUE": "Gross Margin plan\n"}, {"Id": "fdde994d-579f-4ffa-8b5a-fdb9706de1d0", "ObjectType": "cnfg.KPI", "ObjectId": "0b52c7e3-8602-42dd-a14d-7324ac6e34fe", "LocalizationCode": "en", "VALUE": "Nepřímá sleva"}, {"Id": "dfd28a66-76c0-47eb-9a78-a5cbb282500d", "ObjectType": "cnfg.KPI", "ObjectId": "1a99aca0-3ab6-4838-9cce-3589b09e7d5b", "LocalizationCode": "en", "VALUE": "GRPs"}, {"Id": "2f629944-8127-4591-ab37-089f2cd8e9f2", "ObjectType": "cnfg.KPI", "ObjectId": "d2e299a7-0781-4151-b224-574faf19a6e1", "LocalizationCode": "en", "VALUE": null}, {"Id": "035f3e6c-fed1-413e-8b4e-e278b61d5458", "ObjectType": "cnfg.KPI", "ObjectId": "ad8443ec-9e0a-44fe-96a8-cc3cc656ee59", "LocalizationCode": "en", "VALUE": "kpi_kpi_fixed_investment"}, {"Id": "73a50f81-e48e-4982-af40-20b7011df70f", "ObjectType": "cnfg.KPI", "ObjectId": "bcd8855a-87d1-412a-8fa8-9d01def3a2c9", "LocalizationCode": "en", "VALUE": "Actual Budget, local currency"}, {"Id": "eac56d27-7c1f-45f7-a825-20e5e772eca5", "ObjectType": "cnfg.KPI", "ObjectId": "f00be0a2-82d5-47ec-ba59-580dfcd44cd8", "LocalizationCode": "en", "VALUE": null}, {"Id": "a98cd3fc-28db-45f0-be41-42a9a482ed5a", "ObjectType": "cnfg.KPI", "ObjectId": "7de15a97-620c-4712-8f11-74335e90df80", "LocalizationCode": "en", "VALUE": null}, {"Id": "73f62942-7f9a-45f2-96ea-49724cd96e7d", "ObjectType": "cnfg.KPI", "ObjectId": "a8f00a79-5fc9-4cdd-bfdd-d31953b5b029", "LocalizationCode": "en", "VALUE": null}, {"Id": "713238a3-b7a2-48a0-8291-991d27ea7246", "ObjectType": "cnfg.KPI", "ObjectId": "d785974a-6960-4d01-b270-134f924a66ef", "LocalizationCode": "en", "VALUE": null}, {"Id": "f5e3adfe-4351-453c-a46d-d9fb900fa88d", "ObjectType": "cnfg.KPI", "ObjectId": "5de2289d-917b-4b3e-b1b0-9f0f097a948c", "LocalizationCode": "en", "VALUE": null}, {"Id": "c3292eb1-255c-4c41-9f2d-4f3454bc455c", "ObjectType": "cnfg.KPI", "ObjectId": "4ba5c7bb-8e47-415a-9094-d63b2fac0952", "LocalizationCode": "en", "VALUE": null}, {"Id": "e6e58c54-a10a-48bd-9d92-c3d334f5ae66", "ObjectType": "cnfg.KPI", "ObjectId": "8c46c348-d156-4074-b6c0-64b621c1c08b", "LocalizationCode": "en", "VALUE": "Net Revenue \nact"}, {"Id": "2583fcdf-a7e4-4653-8688-be0bde40569b", "ObjectType": "cnfg.KPI", "ObjectId": "366c8e7e-a976-4f8a-b297-02f8e75a12f7", "LocalizationCode": "en", "VALUE": "Sales Margin\nact"}, {"Id": "23c6f304-78f7-4cab-a52c-03f971dea37e", "ObjectType": "cnfg.KPI", "ObjectId": "b6377cbb-6bb7-40f6-9690-3f04888df25a", "LocalizationCode": "en", "VALUE": "Gross Margin\nact"}, {"Id": "b0a51436-751e-49c1-b578-1a4288c0535f", "ObjectType": "cnfg.KPI", "ObjectId": "b113aecb-9530-4e35-a1f9-c2743b785508", "LocalizationCode": "en", "VALUE": null}, {"Id": "122bf8aa-a793-44fa-9b0b-cee237c8f725", "ObjectType": "cnfg.KPI", "ObjectId": "22d33f9b-0aba-4c19-80b9-7df23ba6e9fc", "LocalizationCode": "en", "VALUE": null}, {"Id": "7cbc247e-4cdb-4e65-9fc0-f17259193678", "ObjectType": "cnfg.KPI", "ObjectId": "447ab844-d672-49f4-af05-8a457d640072", "LocalizationCode": "en", "VALUE": null}, {"Id": "0c2d0ba7-a285-4138-97a9-a940ae1947db", "ObjectType": "cnfg.KPI", "ObjectId": "c996c439-38a7-432c-b7bb-c107dc70b281", "LocalizationCode": "en", "VALUE": null}, {"Id": "c9d7d86b-1cbc-4519-9101-ec7c581c2fa9", "ObjectType": "cnfg.KPI", "ObjectId": "4d311e0e-1ccb-4cc8-a24d-c4b29cb875ed", "LocalizationCode": "en", "VALUE": null}, {"Id": "e666fd1d-06bd-401c-b647-f2acc3ddff4e", "ObjectType": "cnfg.KPI", "ObjectId": "7bcdfeb7-73c3-4905-aaec-6dcd0eb333c7", "LocalizationCode": "en", "VALUE": null}, {"Id": "56f4aa7c-a503-48bd-b93b-b2e646fc65a3", "ObjectType": "cnfg.KPI", "ObjectId": "390275af-770a-47ad-baf7-b3f773fea067", "LocalizationCode": "en", "VALUE": null}, {"Id": "7a135337-bb2c-459b-8658-649116fda4f6", "ObjectType": "cnfg.KPI", "ObjectId": "6d2c2d36-5daa-48e2-86c1-ddaaef4862cc", "LocalizationCode": "en", "VALUE": null}, {"Id": "208e12fc-4070-4f11-9646-790db7091f0f", "ObjectType": "cnfg.KPI", "ObjectId": "25cbd492-9f69-4a3d-a064-01ba63bbcb83", "LocalizationCode": "en", "VALUE": null}, {"Id": "311f3f06-01c9-4e2f-ac68-6d9f739929b7", "ObjectType": "cnfg.KPI", "ObjectId": "16f52640-b533-4851-844a-cc1ef4a5206b", "LocalizationCode": "en", "VALUE": null}, {"Id": "2c149b22-4742-4dcf-9fe8-9dfe5486b4ba", "ObjectType": "cnfg.KPI", "ObjectId": "13313bf6-ccb3-443a-8f8d-fa98b0a348e8", "LocalizationCode": "en", "VALUE": null}, {"Id": "092ffbde-dbe5-4690-9770-5d6b3a203f22", "ObjectType": "cnfg.KPI", "ObjectId": "6ac89799-3f7c-4027-b71a-912c6dc798aa", "LocalizationCode": "en", "VALUE": null}, {"Id": "f32c2efd-0570-46e4-b293-7bca65496efb", "ObjectType": "cnfg.KPI", "ObjectId": "e1c69120-aa1d-43c7-a101-ed981e27fa73", "LocalizationCode": "en", "VALUE": null}, {"Id": "f686fdf4-31b6-4e6b-a409-76121fc2e6cb", "ObjectType": "cnfg.KPI", "ObjectId": "88eafbef-508d-473f-9b79-88a3155b3ff9", "LocalizationCode": "en", "VALUE": null}, {"Id": "6d5e82e2-bf5b-4f34-9a8c-56045afd4cb2", "ObjectType": "cnfg.KPI", "ObjectId": "9f4e3bf2-5d19-459a-8f7e-bdef4307a771", "LocalizationCode": "en", "VALUE": null}, {"Id": "c7048b74-d3e8-4beb-a2b8-490411ea13b6", "ObjectType": "cnfg.KPI", "ObjectId": "a4620180-c52d-41da-baf9-0c770a638da0", "LocalizationCode": "en", "VALUE": null}, {"Id": "bb20df1f-8398-4dcc-ba19-b38a8f4ee2d3", "ObjectType": "cnfg.KPI", "ObjectId": "893c36fc-b5e0-45c5-b4c0-1c56309ad1ec", "LocalizationCode": "en", "VALUE": null}, {"Id": "1867bc84-b08e-4835-a221-68863684433b", "ObjectType": "cnfg.KPI", "ObjectId": "cf9980bf-b56f-4b1e-8d03-3e6d253a52be", "LocalizationCode": "en", "VALUE": null}, {"Id": "7eb818f2-a6bf-415f-a532-3a6d1a78bd99", "ObjectType": "cnfg.KPI", "ObjectId": "3acc0e80-058c-4029-b92f-f051c81353ce", "LocalizationCode": "en", "VALUE": null}, {"Id": "222c836d-4b87-4120-9113-d7fe5ca9f909", "ObjectType": "cnfg.KPI", "ObjectId": "a3376192-e5a5-4bf9-8eee-745a1b1d267b", "LocalizationCode": "en", "VALUE": null}, {"Id": "d3be96e3-68af-4f65-b509-ece9c7a94cd7", "ObjectType": "cnfg.KPI", "ObjectId": "676495b2-c283-4a51-8169-fa84e6474f46", "LocalizationCode": "en", "VALUE": "ROPI (price on shelf from SFA MM) plan\n"}, {"Id": "d4039f80-1f42-4d6b-9a90-a02490e4856a", "ObjectType": "cnfg.KPI", "ObjectId": "6a6221f2-c350-4178-929b-ad838667de34", "LocalizationCode": "en", "VALUE": "Net Revenue plan"}, {"Id": "0fa506bc-319f-4327-9bc4-1217935fc708", "ObjectType": "cnfg.KPI", "ObjectId": "8dfc3e94-ba11-46db-90d1-1ea3fb972d98", "LocalizationCode": "en", "VALUE": "Sales Margin plan\n"}, {"Id": "b97a91c7-3edb-48e0-9883-dc6c6925a84e", "ObjectType": "cnfg.KPI", "ObjectId": "65ae949d-1264-42dd-a4ec-f68f8eace7e0", "LocalizationCode": "en", "VALUE": "Fixed Investment"}, {"Id": "e1260230-1dbb-4482-a318-2277daeac856", "ObjectType": "cnfg.KPI", "ObjectId": "c55f7f77-eb98-4571-92d9-fa42b35341b9", "LocalizationCode": "en", "VALUE": "Reach"}, {"Id": "a48a5da2-896b-4212-9be0-fa809f1dec35", "ObjectType": "cnfg.KPI", "ObjectId": "e364fcdb-c3dd-41e5-9999-678371ea3315", "LocalizationCode": "en", "VALUE": null}, {"Id": "054631f8-8842-4420-b5dc-a241f07f7eb7", "ObjectType": "cnfg.KPI", "ObjectId": "c0cec776-1d4f-4892-963d-2ced043c10f0", "LocalizationCode": "en", "VALUE": null}, {"Id": "53d5706d-e7ad-48f3-9efc-b1247c8c62fa", "ObjectType": "cnfg.KPI", "ObjectId": "a1176b3e-dba4-466d-8b0e-7117ba6c8c11", "LocalizationCode": "en", "VALUE": null}, {"Id": "75e4f7ee-c7b2-49ae-9a8f-9df8ec37153e", "ObjectType": "cnfg.KPI", "ObjectId": "8759c670-0030-4ff1-afcf-06975bbf4ac9", "LocalizationCode": "en", "VALUE": "In/Out of Guideline"}, {"Id": "0b4c646e-1129-46ac-b8d8-60b4ea6ab2a3", "ObjectType": "cnfg.KPI", "ObjectId": "efb94b12-b97b-4a50-a331-26a80b445535", "LocalizationCode": "en", "VALUE": "In/Out of Guideline"}, {"Id": "fed0d6ad-2f5a-497c-ba9a-48e9fba41296", "ObjectType": "cnfg.KPI", "ObjectId": "ac380a92-2587-456b-9300-ff5af7566e11", "LocalizationCode": "en", "VALUE": "Planned # of Promo SKU"}, {"Id": "9c94e68e-91f0-4284-a389-4580ed6dadad", "ObjectType": "cnfg.KPI", "ObjectId": "f3490581-61d6-4c6a-8a36-024a3bece1c4", "LocalizationCode": "en", "VALUE": null}, {"Id": "9fa15ceb-6c0a-442a-b453-e9c0ce184978", "ObjectType": "cnfg.KPI", "ObjectId": "3c53b5d3-1ab5-4144-8e29-36197ef1fb71", "LocalizationCode": "en", "VALUE": null}, {"Id": "8dd1b041-3dc2-4b1c-9d66-edf4da119e63", "ObjectType": "cnfg.KPI", "ObjectId": "9f12f35f-9830-4935-8af7-104b25587d03", "LocalizationCode": "en", "VALUE": "ROPI (price on shelf from SFA MM) act"}, {"Id": "6a5596b9-0817-408b-8d38-00d12a68534d", "ObjectType": "cnfg.KPI", "ObjectId": "c4e36867-68c0-43ef-9b6f-2d3c339fa08e", "LocalizationCode": "en", "VALUE": "Main Forecast"}, {"Id": "be190a1b-50aa-470c-ac58-c55ef3aff3e2", "ObjectType": "cnfg.KPI", "ObjectId": "40619500-6509-43cd-b33a-6cd0e9b5c785", "LocalizationCode": "en", "VALUE": null}, {"Id": "59fb202d-903b-4fb0-a00f-caa902789239", "ObjectType": "cnfg.KPI", "ObjectId": "d9eea63b-5603-4e83-a2c7-f72e918b865e", "LocalizationCode": "en", "VALUE": "Planned volume"}, {"Id": "12666de8-230c-4772-b9a1-a8fc81271fb3", "ObjectType": "cnfg.KPI", "ObjectId": "bfb41446-91b3-45c0-839f-50c278b1ad45", "LocalizationCode": "en", "VALUE": "Actual volume"}, {"Id": "417fbf66-4e92-4ad2-a572-a776d65defa8", "ObjectType": "cnfg.KPI", "ObjectId": "c36f5330-3b79-4e1e-a85d-6b7a7a5bc3ec", "LocalizationCode": "en", "VALUE": "Min_Budgeted_Promo_price_total"}, {"Id": "84d65077-c58a-47ea-a9c9-42bf0cee8a74", "ObjectType": "cnfg.KPI", "ObjectId": "ae1bc6fc-b99a-4619-9d5e-4a7e3e53b595", "LocalizationCode": "en", "VALUE": "Baseline VBB (tech)"}, {"Id": "384a65ba-0e15-45e1-bba8-3d94ee1543ed", "ObjectType": "cnfg.KPI", "ObjectId": "90528ece-85a8-4b09-8f3e-a7f303957d85", "LocalizationCode": "en", "VALUE": "Pre-promo volume"}, {"Id": "f95d1aca-9042-4433-87a9-0ea3d47239ed", "ObjectType": "cnfg.KPI", "ObjectId": "8f18f1f0-e620-4a22-b58a-a4ee510240f5", "LocalizationCode": "en", "VALUE": "After-promo volume"}, {"Id": "23c61778-4263-487f-95d5-241655c2876b", "ObjectType": "cnfg.KPI", "ObjectId": "ff4ec5ee-2ca4-4f51-8201-50262301669f", "LocalizationCode": "en", "VALUE": null}, {"Id": "18c5dc85-b309-4df3-b793-c8541f46d0f9", "ObjectType": "cnfg.KPI", "ObjectId": "722754d6-d4d1-4579-805a-152ecbba251d", "LocalizationCode": "en", "VALUE": null}, {"Id": "ec3e8009-95a5-413a-91b5-7a3c97a23f28", "ObjectType": "cnfg.KPI", "ObjectId": "bfdb0ed0-268b-46aa-a8ad-67991c288793", "LocalizationCode": "en", "VALUE": null}, {"Id": "6145d293-e6f8-4ee2-a817-d4b77137569e", "ObjectType": "cnfg.KPI", "ObjectId": "f98d2319-a179-4bad-ae0d-baa0075432b0", "LocalizationCode": "en", "VALUE": null}, {"Id": "d73c47fa-29c7-4cc8-a854-aec7e58892d0", "ObjectType": "cnfg.KPI", "ObjectId": "18b090d5-9e86-4790-8dfd-ad99b563fa6b", "LocalizationCode": "en", "VALUE": "Promo objem Calc - návrh (ks)"}, {"Id": "e116d47a-8bf3-4c53-89c1-7c114c659f3a", "ObjectType": "cnfg.KPI", "ObjectId": "a000ff52-c6c6-435c-b0db-04280079bee8", "LocalizationCode": "en", "VALUE": null}, {"Id": "20eddd5a-25d1-4967-ba5a-22f2042c9052", "ObjectType": "cnfg.KPI", "ObjectId": "d168682b-559a-4313-8848-23b34dfac62f", "LocalizationCode": "en", "VALUE": null}, {"Id": "694e2a14-c28e-4674-9a94-9f317c9cd97d", "ObjectType": "cnfg.KPI", "ObjectId": "d962b723-d73e-4ec1-8aa7-22b27707c211", "LocalizationCode": "en", "VALUE": "Manual Adjustment"}, {"Id": "655884f5-4b02-4b75-b674-7b3a10a59a75", "ObjectType": "cnfg.KPI", "ObjectId": "100e8819-9668-4044-bacc-e2ae8744734d", "LocalizationCode": "en", "VALUE": null}, {"Id": "e8b4af85-35b4-47f6-b067-56d4036934ee", "ObjectType": "cnfg.KPI", "ObjectId": "e8fd4c44-51d7-453e-9fc7-579640e8d8ce", "LocalizationCode": "en", "VALUE": null}, {"Id": "e4385984-ee55-433b-aee2-abc85a08cac5", "ObjectType": "cnfg.KPI", "ObjectId": "fa76dbc8-85ab-47ff-874a-1b5242d7d5ff", "LocalizationCode": "en", "VALUE": "Code"}, {"Id": "5b691f7c-8909-4c29-ad2a-90fefecd3d2a", "ObjectType": "cnfg.KPI", "ObjectId": "7daf5436-18cb-47a4-8510-2b9eabd2b953", "LocalizationCode": "en", "VALUE": "Code of material pricing Group"}, {"Id": "33d411f4-1c89-4451-a972-04cf081b50f8", "ObjectType": "cnfg.KPI", "ObjectId": "9282333e-6e27-4d7e-aa12-16c352764a52", "LocalizationCode": "en", "VALUE": "SelIn_read"}, {"Id": "b8e3117b-4d7f-4543-97c9-d5b90ca9c501", "ObjectType": "cnfg.KPI", "ObjectId": "60fb6bdb-926d-4485-9447-27527a420ddc", "LocalizationCode": "en", "VALUE": null}, {"Id": "2771ec70-7eb8-4803-a2b9-9e2199f231b3", "ObjectType": "cnfg.KPI", "ObjectId": "7ae4c513-8358-496b-944f-aa6d10d910c8", "LocalizationCode": "en", "VALUE": "vbb"}, {"Id": "3ad49427-a70a-4fdc-a6ef-84095f33fd83", "ObjectType": "cnfg.KPI", "ObjectId": "53cf61bd-48c8-4ade-b2eb-a5df8e35b183", "LocalizationCode": "en", "VALUE": null}, {"Id": "7e84bb77-4af1-4c20-8428-92158897bf9e", "ObjectType": "cnfg.KPI", "ObjectId": "f294ed6c-5928-40a8-ad9d-d49d849592da", "LocalizationCode": "en", "VALUE": null}, {"Id": "2d96cdb1-8049-4d57-b8c3-5382a487c5cd", "ObjectType": "cnfg.KPI", "ObjectId": "d06fb36d-522a-4bcf-b231-7a3cdef71366", "LocalizationCode": "en", "VALUE": "Fixní investice v kč"}, {"Id": "f0805a35-d0c8-4e83-813b-3cbd45b8439f", "ObjectType": "cnfg.KPI", "ObjectId": "491ab7fc-6794-480f-a18d-9a1f730b6e8f", "LocalizationCode": "en", "VALUE": "Baseline (automatically), 1000pcs"}, {"Id": "ab2f033b-3db2-4f69-be7b-368e8cc2ec37", "ObjectType": "cnfg.KPI", "ObjectId": "abc4773a-5d07-40b1-b3ac-b4d99f073bb7", "LocalizationCode": "en", "VALUE": "Promo price proposal (manually) HU"}, {"Id": "09134fa9-ad42-456b-9425-d2ffe4182758", "ObjectType": "cnfg.KPI", "ObjectId": "b697d4ca-bdef-42ca-ac77-9130c9f84ce9", "LocalizationCode": "en", "VALUE": "Promo price with Health TAX"}, {"Id": "b9fbe947-4f21-45f1-9da6-2febd55174fa", "ObjectType": "cnfg.KPI", "ObjectId": "f3e36af5-afb2-4278-acd5-44c00d319cc5", "LocalizationCode": "en", "VALUE": "SelIn"}, {"Id": "79926b04-4ef5-4490-accc-b447593fb563", "ObjectType": "cnfg.KPI", "ObjectId": "a82949ad-3124-4177-ab2f-5d0b88114357", "LocalizationCode": "en", "VALUE": "Guideline KPI"}, {"Id": "9f457b61-470d-4fad-87f6-5da097885000", "ObjectType": "cnfg.KPI", "ObjectId": "15d56b03-bb8d-424f-8956-17d21e953a30", "LocalizationCode": "en", "VALUE": null}, {"Id": "e284b26e-87f5-43c9-8fe9-ddd244421e69", "ObjectType": "cnfg.KPI", "ObjectId": "d0e5efbb-e851-4456-89bd-7a8fb6df8bcd", "LocalizationCode": "en", "VALUE": null}, {"Id": "3d1510cb-161d-43ca-96d5-5313d935d0a4", "ObjectType": "cnfg.KPI", "ObjectId": "126c290c-f2aa-4d3f-a77a-7f89dd0485fb", "LocalizationCode": "en", "VALUE": null}, {"Id": "efe09656-021a-45eb-a6c7-0994fec60dc6", "ObjectType": "cnfg.KPI", "ObjectId": "dadb56b1-47d9-4115-a591-551461affb60", "LocalizationCode": "en", "VALUE": null}, {"Id": "492f3a96-3d10-439f-a3f6-d30b31c8f99a", "ObjectType": "cnfg.KPI", "ObjectId": "4825a06c-9f2a-4c31-b221-72dcfc18dded", "LocalizationCode": "en", "VALUE": null}, {"Id": "3155cbfe-4320-49ab-8359-83b984ac7fa8", "ObjectType": "cnfg.KPI", "ObjectId": "43ee17c3-56c6-4509-a2d4-b3de4d4cf833", "LocalizationCode": "en", "VALUE": null}, {"Id": "2bdfda3a-868e-4529-8f64-179abdfc1da5", "ObjectType": "cnfg.KPI", "ObjectId": "0d0a32c8-3815-409f-989f-30dbfb90077c", "LocalizationCode": "en", "VALUE": null}, {"Id": "4347081c-872c-4065-8227-e8c76e599b98", "ObjectType": "cnfg.KPI", "ObjectId": "c2620d76-5d46-4259-8256-7d07ecede44c", "LocalizationCode": "en", "VALUE": null}, {"Id": "fd3017c3-9de1-45b9-a1e5-70849a2884c3", "ObjectType": "cnfg.KPI", "ObjectId": "1d42b329-0b98-4cab-8906-faac59012621", "LocalizationCode": "en", "VALUE": null}, {"Id": "c2ced792-22d2-44be-928d-c044a2df4631", "ObjectType": "cnfg.KPI", "ObjectId": "43e71edb-0f49-413e-bce0-77f6a307840b", "LocalizationCode": "en", "VALUE": null}, {"Id": "7da97a65-0eaf-48af-bddd-7f6ef9f0f178", "ObjectType": "cnfg.KPI", "ObjectId": "4ce869de-ccca-4eec-96e6-8725ce074c06", "LocalizationCode": "en", "VALUE": null}, {"Id": "627a74cc-f25f-48de-8fd6-302cdc0b2add", "ObjectType": "cnfg.KPI", "ObjectId": "d0d4f40f-61f1-456b-9be0-03b2b08d3442", "LocalizationCode": "en", "VALUE": null}, {"Id": "9255fc4b-20ca-4bca-a2eb-3d8d7e440388", "ObjectType": "cnfg.KPI", "ObjectId": "b45c13b3-41c1-4737-83c8-a9ba29a4d574", "LocalizationCode": "en", "VALUE": null}, {"Id": "63633ea7-1f16-4644-870e-44d473717ac1", "ObjectType": "cnfg.KPI", "ObjectId": "4d11f32f-ea31-4b05-918a-4fafcbca9d8d", "LocalizationCode": "en", "VALUE": null}, {"Id": "ff45fd75-3a53-4914-86e4-51372e5b7a42", "ObjectType": "cnfg.KPI", "ObjectId": "0a4fc7e8-dc10-4f28-b14f-5367f0133554", "LocalizationCode": "en", "VALUE": null}, {"Id": "e3e6f89e-f613-4a32-b06a-448f2104db3c", "ObjectType": "cnfg.KPI", "ObjectId": "e8b48be5-eaaa-47e2-89ee-6e7ae2b0aea6", "LocalizationCode": "en", "VALUE": null}, {"Id": "cea4b86d-132a-4f02-8786-5c202d7f03b6", "ObjectType": "cnfg.KPI", "ObjectId": "1a6a1bad-ab3b-44bc-83a3-9f3bf172f661", "LocalizationCode": "en", "VALUE": null}, {"Id": "1a55bfa0-a922-4feb-a9fe-b038621706dc", "ObjectType": "cnfg.KPI", "ObjectId": "1447c10f-e2ba-4ddc-8aa0-ea23f33baaa2", "LocalizationCode": "en", "VALUE": null}, {"Id": "18c48465-39b1-43e1-beca-0384de5533bd", "ObjectType": "cnfg.KPI", "ObjectId": "c2660364-49e9-4aab-a141-e1798d8e763c", "LocalizationCode": "en", "VALUE": null}, {"Id": "61d53876-4d6f-4925-87c0-fb2d7028aea6", "ObjectType": "cnfg.KPI", "ObjectId": "0b5716e8-21ca-4039-aa59-aac9e211ae05", "LocalizationCode": "en", "VALUE": null}, {"Id": "d25ccbbb-4d66-4bbf-a09d-e002097a8c43", "ObjectType": "cnfg.KPI", "ObjectId": "b7de5247-1f0b-4265-b48f-b4184a62cb92", "LocalizationCode": "en", "VALUE": null}, {"Id": "83476ded-a150-4679-aa1d-a2ae5d9b24aa", "ObjectType": "cnfg.KPI", "ObjectId": "e3417346-6e71-4cfa-b95d-db1b23ff2be2", "LocalizationCode": "en", "VALUE": null}, {"Id": "bedf317e-9999-4cec-b3a5-79bc64da2705", "ObjectType": "cnfg.KPI", "ObjectId": "e33d2d2a-b5be-4f2a-b61f-57e1abc7d300", "LocalizationCode": "en", "VALUE": null}, {"Id": "3891ca60-5bd2-4fb8-9194-c02538f1ced6", "ObjectType": "cnfg.KPI", "ObjectId": "93c43aeb-867b-48f2-8e0a-0c3c17fbf0fa", "LocalizationCode": "en", "VALUE": null}, {"Id": "efde026f-f945-48a0-af21-87fabb2a4c27", "ObjectType": "cnfg.KPI", "ObjectId": "80fdd0c8-cd25-4694-af2d-b7efbde7029c", "LocalizationCode": "en", "VALUE": null}, {"Id": "cf3faaed-7762-4421-a419-a20554fe6f79", "ObjectType": "cnfg.KPI", "ObjectId": "c4e316f2-737d-4fc7-a155-e1792ec32218", "LocalizationCode": "en", "VALUE": null}, {"Id": "1d268d96-9e24-47f5-a224-5c4b066d0fcb", "ObjectType": "cnfg.KPI", "ObjectId": "4a9522a7-0082-4bbc-867e-6c605024af92", "LocalizationCode": "en", "VALUE": null}, {"Id": "400bcba7-866d-47a7-8efd-3890f1bff128", "ObjectType": "cnfg.KPI", "ObjectId": "a2c2bb8f-7aaa-4987-8876-ba7011b2dc61", "LocalizationCode": "en", "VALUE": null}, {"Id": "d22332e7-0be6-4b89-bbc7-d2e98ebfa19b", "ObjectType": "cnfg.KPI", "ObjectId": "8ffb345d-53f3-4fee-9020-1602a168d33c", "LocalizationCode": "en", "VALUE": null}, {"Id": "e0e30599-4ce4-4264-9f7c-1ae07062d4ac", "ObjectType": "cnfg.KPI", "ObjectId": "717818f5-d64f-4ed7-9d3e-2716fc96e277", "LocalizationCode": "en", "VALUE": null}, {"Id": "6533df66-bc89-495f-a4ad-0e0342b43ae3", "ObjectType": "cnfg.KPI", "ObjectId": "612cb247-6cb9-48c7-97d1-9d761e77be8b", "LocalizationCode": "en", "VALUE": null}, {"Id": "590d04eb-7df9-4450-b227-e53e0071ea77", "ObjectType": "cnfg.KPI", "ObjectId": "ef24632d-b51e-446f-9222-8a8e7f2d04c3", "LocalizationCode": "en", "VALUE": null}, {"Id": "3b4064c8-8c48-4512-b832-b334fdda90a6", "ObjectType": "cnfg.KPI", "ObjectId": "b9f986d9-d4d2-49b7-84e6-dedeaeec8545", "LocalizationCode": "en", "VALUE": "Promo Type GuideKPI"}, {"Id": "5cfaf0a6-d999-43e1-a13a-2724faf7124f", "ObjectType": "cnfg.KPI", "ObjectId": "e995a3ea-0ea9-46de-9bc0-c09a10f23751", "LocalizationCode": "en", "VALUE": "Combination to avoid, In/Out of Guideline"}, {"Id": "7728a766-c130-426a-b9c7-af9bc539fa1f", "ObjectType": "cnfg.KPI", "ObjectId": "8b977a54-806e-4179-8e4e-a9e804538c18", "LocalizationCode": "en", "VALUE": null}, {"Id": "eb8e401b-1dfa-4b9a-af3d-09627a243499", "ObjectType": "cnfg.KPI", "ObjectId": "7550f4e0-eb14-4e19-8330-e9379733313e", "LocalizationCode": "en", "VALUE": null}, {"Id": "c7771410-d48e-44d9-a386-6f635c092a68", "ObjectType": "cnfg.KPI", "ObjectId": "7983cf55-158d-4a0e-9ac0-2ced594a5c8f", "LocalizationCode": "en", "VALUE": null}, {"Id": "567941e0-e7f7-4c16-b57c-1870fb9bd699", "ObjectType": "cnfg.KPI", "ObjectId": "ca40e0a0-9e06-436b-9992-0baaa778d9f3", "LocalizationCode": "en", "VALUE": "Combination to recommend, In/Out of Guideline"}, {"Id": "63d614c9-4d88-431e-ae63-2c39bccc7050", "ObjectType": "cnfg.KPI", "ObjectId": "84b835b0-8b35-46b1-bf6e-edbaddf08631", "LocalizationCode": "en", "VALUE": null}, {"Id": "e90bba51-d397-4a2c-b655-fb6a2e06189b", "ObjectType": "cnfg.KPI", "ObjectId": "8f256c85-1a85-46cd-8307-080c59cad3f4", "LocalizationCode": "en", "VALUE": null}, {"Id": "8fafc2b8-32db-42c2-8a30-ee0aa0ff58a6", "ObjectType": "cnfg.KPI", "ObjectId": "ec19abbe-3571-4308-ad84-1cd05a59ed16", "LocalizationCode": "en", "VALUE": null}, {"Id": "4749118e-4a7d-406c-859d-6e8e907963a2", "ObjectType": "cnfg.KPI", "ObjectId": "9764bceb-8e51-41e2-a9fa-1f8f3653297c", "LocalizationCode": "en", "VALUE": null}, {"Id": "7be95772-b901-4cad-99af-0a47a20220b9", "ObjectType": "cnfg.KPI", "ObjectId": "3cebe90d-6113-4d6d-83e6-32abbd567d45", "LocalizationCode": "en", "VALUE": null}, {"Id": "d633173b-66f0-4196-8cec-b066d885692d", "ObjectType": "cnfg.KPI", "ObjectId": "07fe61c3-2579-4c84-82b5-d9d92fe7ccf9", "LocalizationCode": "en", "VALUE": null}, {"Id": "a07dc2c5-5f25-45a7-89cc-c366c6f6c809", "ObjectType": "cnfg.KPI", "ObjectId": "208b6a13-d70a-4764-aac8-772a2470dc22", "LocalizationCode": "en", "VALUE": null}, {"Id": "b3ea5522-d3db-49db-b3e7-1c9eb5ac4fc8", "ObjectType": "cnfg.KPI", "ObjectId": "588add38-617e-4324-8c2c-bd283c058b43", "LocalizationCode": "en", "VALUE": null}, {"Id": "ec49fad9-af2d-46f1-979f-c65ab8655d9f", "ObjectType": "cnfg.KPI", "ObjectId": "d96ad067-bf8a-46ac-a2eb-65ad65d48aac", "LocalizationCode": "en", "VALUE": "Combination to recommend, Guideline"}, {"Id": "eea39924-5218-4417-bb35-e460d50b1017", "ObjectType": "cnfg.KPI", "ObjectId": "8be28b7e-0cef-4c84-8aa1-9a767d95a6cc", "LocalizationCode": "en", "VALUE": null}, {"Id": "c8fde30e-7369-499a-bc4d-ad5f0a987bd3", "ObjectType": "cnfg.KPI", "ObjectId": "04624e9f-426b-4969-91c7-b6edd57eba30", "LocalizationCode": "en", "VALUE": null}, {"Id": "ba05b5bb-60bf-4968-bfd4-73f26e2bc401", "ObjectType": "cnfg.KPI", "ObjectId": "1eeacde4-8f85-4062-b394-d5a78efcfc5c", "LocalizationCode": "en", "VALUE": null}, {"Id": "323ba398-1188-485d-99b9-890015404ca8", "ObjectType": "cnfg.KPI", "ObjectId": "dae382bc-79f0-46c7-8f11-4a586ab10f0a", "LocalizationCode": "en", "VALUE": null}, {"Id": "9d282967-cb39-4c2f-bac3-a2f8e4f98f15", "ObjectType": "cnfg.KPI", "ObjectId": "a374d13e-fa75-4049-bf40-f0c00926a868", "LocalizationCode": "en", "VALUE": null}, {"Id": "4b1bb7d7-9f3d-479a-a48a-2ca7ba71bd02", "ObjectType": "cnfg.KPI", "ObjectId": "248e88cb-f99e-4ffc-9ffa-eaf80dd4e329", "LocalizationCode": "en", "VALUE": "Planned # of Promo L9"}, {"Id": "a9f9d178-af73-4948-a046-a7b853a09e12", "ObjectType": "cnfg.KPI", "ObjectId": "70a5a583-2f2e-462e-8bcb-6314306a4a19", "LocalizationCode": "en", "VALUE": "Baseline"}, {"Id": "db782aba-e1db-4e64-9535-f924dc6a6c5c", "ObjectType": "cnfg.KPI", "ObjectId": "b9c7eaf7-a9ce-4d9e-9b73-43cf23edc028", "LocalizationCode": "en", "VALUE": "Incremental Promo Volume"}, {"Id": "1ad4a24f-c3a9-4cdf-8738-9f33c5366455", "ObjectType": "cnfg.KPI", "ObjectId": "67109be2-dda8-4df6-8bff-fc576c6419ca", "LocalizationCode": "en", "VALUE": "Promo_Volume_Past (tech)"}, {"Id": "83793c8a-4083-40e1-bd44-4e8409e73d61", "ObjectType": "cnfg.KPI", "ObjectId": "510b67f3-9dbf-432a-80e9-6e3c296e935f", "LocalizationCode": "en", "VALUE": "frcPromoVolumePast(tech)"}, {"Id": "ebd64164-6c96-4bde-b3a8-001891f094eb", "ObjectType": "cnfg.KPI", "ObjectId": "a8058eed-4f11-4e7f-a813-9f7184116148", "LocalizationCode": "en", "VALUE": "frcPromoVolumeShort(tech)"}, {"Id": "78c1f832-a70d-43f7-b324-0be1a82b1886", "ObjectType": "cnfg.KPI", "ObjectId": "0f673ae7-31fb-49c7-ade3-2eaca5468ddf", "LocalizationCode": "en", "VALUE": "frcGrothRate(del)"}, {"Id": "a925bf8c-d295-438f-9800-fd047a3b0d50", "ObjectType": "cnfg.KPI", "ObjectId": "61647ec0-364c-4d66-9bd4-70398a7b395d", "LocalizationCode": "en", "VALUE": "allRelevantGuides"}, {"Id": "39d5c453-06e0-42b1-a041-b8d38e47270e", "ObjectType": "cnfg.KPI", "ObjectId": "1ca862eb-4ab1-49bd-97fe-9b15e4f9d1ae", "LocalizationCode": "en", "VALUE": "Highlight for In/Out of Guidline"}, {"Id": "23012cf3-9177-4444-9737-2fe9c0dfb357", "ObjectType": "cnfg.KPI", "ObjectId": "44664f1a-f8b6-40f7-a0eb-a4c9fd1e0457", "LocalizationCode": "en", "VALUE": "Combination to avoid, Guideline"}, {"Id": "97a1ffbb-f300-4663-bb7f-581ff6546730", "ObjectType": "cnfg.KPI", "ObjectId": "32cb9855-2ed4-4c75-9d07-cbdb3b23828c", "LocalizationCode": "en", "VALUE": null}, {"Id": "c1d6b726-0099-49d7-856e-d56dfea96ef3", "ObjectType": "cnfg.KPI", "ObjectId": "4e33c67c-2672-40b9-854d-441f2b0ae5f4", "LocalizationCode": "en", "VALUE": null}, {"Id": "09db122e-d478-4a23-9304-1d824546a12a", "ObjectType": "cnfg.KPI", "ObjectId": "8cdd99b8-6acc-4237-b707-ac58b31a6edd", "LocalizationCode": "en", "VALUE": "Promo Type Check, In/Out of Guideline"}, {"Id": "6ab9fe9a-7ad1-414b-9864-9d25d770f6d2", "ObjectType": "cnfg.KPI", "ObjectId": "5dcb5331-5bb3-409d-86eb-c3639b7911aa", "LocalizationCode": "en", "VALUE": "Promotional Type Guideline"}, {"Id": "ec0a7700-ca04-47dd-8bac-732a66241aea", "ObjectType": "cnfg.KPI", "ObjectId": "6e560050-41bb-4ed6-98ca-d989bb8421e6", "LocalizationCode": "en", "VALUE": null}, {"Id": "188a6584-c794-4d32-9a01-3684cfef811c", "ObjectType": "cnfg.KPI", "ObjectId": "f4bff778-2e52-4a39-9c17-3eb70e8105cb", "LocalizationCode": "en", "VALUE": null}, {"Id": "5f4555f3-1de8-43a9-b1cb-880894d5bfb1", "ObjectType": "cnfg.KPI", "ObjectId": "b74e39b5-263e-4dff-9073-ee74a9395497", "LocalizationCode": "en", "VALUE": "Most frequent Promo Price, In/Out of Guideline"}, {"Id": "a076808b-d804-4060-94f0-f96506918471", "ObjectType": "cnfg.KPI", "ObjectId": "9e21fe1a-4d87-49a6-a91a-e89ffe98934e", "LocalizationCode": "en", "VALUE": "Unfolded Baseline (tech)"}, {"Id": "32b95e39-2f58-4022-82a4-0255935d8f9d", "ObjectType": "cnfg.KPI", "ObjectId": "e1345602-d821-4a52-9193-3dfeecd956ec", "LocalizationCode": "en", "VALUE": "Unfolded Baseline"}, {"Id": "7a1c1cdf-23ae-406b-874f-1834a42d793b", "ObjectType": "cnfg.KPI", "ObjectId": "296ee2ff-d503-44bf-88aa-1f2bb7d579c5", "LocalizationCode": "en", "VALUE": "SKU Share (tech)"}, {"Id": "3f8b4377-0108-4393-a763-d518ce96afa8", "ObjectType": "cnfg.KPI", "ObjectId": "d80464cb-4a1c-48fb-9880-ab23bbb7f079", "LocalizationCode": "en", "VALUE": "SKU historical data for L9 (tech)"}, {"Id": "db3345a2-bcc5-431c-8fdd-6c5a609db349", "ObjectType": "cnfg.KPI", "ObjectId": "e9ae7c1e-347b-4291-b8a5-9a0ecde2ea91", "LocalizationCode": "en", "VALUE": "Actual sales"}, {"Id": "f209abfa-13a4-4088-8b0e-27d97ae6a3c4", "ObjectType": "cnfg.KPI", "ObjectId": "4f5f0a72-4185-4e5f-9374-f19f059c2962", "LocalizationCode": "en", "VALUE": null}, {"Id": "8d126ea3-164b-43b9-82c6-127c87615b32", "ObjectType": "cnfg.KPI", "ObjectId": "43e94bab-459a-48b4-81b6-62946a60e354", "LocalizationCode": "en", "VALUE": null}, {"Id": "c00b551a-6695-462d-a30d-68c644dc1dc2", "ObjectType": "cnfg.KPI", "ObjectId": "b867b5c4-7659-4af4-b2e8-aecb035b5ab2", "LocalizationCode": "en", "VALUE": null}, {"Id": "0dcce9d9-8ae5-4e94-8d02-8dfa84225291", "ObjectType": "cnfg.KPI", "ObjectId": "85af2e91-fb7e-428f-9e77-b2a3a3a3facb", "LocalizationCode": "en", "VALUE": "Baseline (automatically) / 1000ks"}, {"Id": "7f7f336d-26cc-4e09-aadd-aeec34b9a996", "ObjectType": "cnfg.KPI", "ObjectId": "38c1a450-1c18-4d7f-95d2-a46c9544bb83", "LocalizationCode": "en", "VALUE": "Promo objem - KAM (1000 ks)"}, {"Id": "cd37f0c1-02c8-4adc-beef-c711380fefb0", "ObjectType": "cnfg.KPI", "ObjectId": "53ab9ca5-34da-49e6-9998-ba3c3e54ec67", "LocalizationCode": "en", "VALUE": null}, {"Id": "d29795c7-f67d-4209-a9ec-1b52ed52e090", "ObjectType": "cnfg.KPI", "ObjectId": "47160d6a-218b-4449-8af3-91da435455c0", "LocalizationCode": "en", "VALUE": "Baseline (automatically) (ks)"}, {"Id": "7ae222c4-49e8-4bff-a99f-8185322823c5", "ObjectType": "cnfg.KPI", "ObjectId": "764ff6cc-decb-42c2-ab94-e650bba15416", "LocalizationCode": "en", "VALUE": null}, {"Id": "b376230b-ce13-4abb-bd89-8cdab0120b99", "ObjectType": "cnfg.KPI", "ObjectId": "e0415bb7-bca1-48b0-898f-883aa9648eda", "LocalizationCode": "en", "VALUE": null}, {"Id": "2ce3844f-cde4-4abb-a5e2-8c784aa16f10", "ObjectType": "cnfg.KPI", "ObjectId": "80f77dd0-8b9f-47be-9469-2e47fa9970b1", "LocalizationCode": "en", "VALUE": "Promo_Volume_Short (tech)"}, {"Id": "044e3899-280e-446d-8545-b7d7d2d398ee", "ObjectType": "cnfg.KPI", "ObjectId": "b482e25b-a47b-4cad-8e00-dafb295bb6bf", "LocalizationCode": "en", "VALUE": "GrowthRate (tech)"}, {"Id": "9feccd96-d7b8-485d-b109-23e01a96631b", "ObjectType": "cnfg.KPI", "ObjectId": "b095b056-37f0-45e4-82bc-2228eacb78f5", "LocalizationCode": "en", "VALUE": "FiFOdaysFoActSales_SelIn (tech)"}, {"Id": "3f724ca7-b5d1-4299-9f55-dc1d3f9a3747", "ObjectType": "cnfg.KPI", "ObjectId": "4b6e050e-25ce-44ba-8881-4b674f4651a8", "LocalizationCode": "en", "VALUE": "FiFOdaysFoActSales_SelOut (tech)"}, {"Id": "51141102-8df9-4759-be69-f3f83d4aeab8", "ObjectType": "cnfg.KPI", "ObjectId": "51fd25bf-d0ca-437d-bcc5-b596deb9c58d", "LocalizationCode": "en", "VALUE": "Forward Buy"}, {"Id": "4677ee26-8657-4c28-bde3-1106551ce15b", "ObjectType": "cnfg.KPI", "ObjectId": "7495b887-d611-4bf5-bd38-7015eaed3fbf", "LocalizationCode": "en", "VALUE": "Actual # of Promo SKU"}, {"Id": "acb9a459-d7e4-4d80-94b2-7b8e73ffd37c", "ObjectType": "cnfg.KPI", "ObjectId": "9e34452a-1db3-47cf-804e-514e84a170b8", "LocalizationCode": "en", "VALUE": null}, {"Id": "d9dd87e4-178f-463c-a369-490389523310", "ObjectType": "cnfg.KPI", "ObjectId": "c767e784-fcab-4a79-be6e-6dd924f6df83", "LocalizationCode": "en", "VALUE": "SKU penetration by Promotion (tech)"}, {"Id": "80c931e8-f10a-4a05-81be-053c04312c80", "ObjectType": "cnfg.KPI", "ObjectId": "7c5be727-9d29-4509-92e5-edfbfd02e867", "LocalizationCode": "en", "VALUE": "Act Sales (tech, frcSKUSalesAsShare)"}], "cnfg.KPIConditionalFormatting.csv": [{"Id": "6d1aacdb-2c36-423c-b5f8-0e92eee33595", "Name": "Highlight_Zero_And_Enabled", "KPIId": "8b4ab946-7ade-4e1f-a579-5cd10d835180", "ConditionKPIId": "43e94bab-459a-48b4-81b6-62946a60e354", "BackColor": -3598.0, "FontColor": null, "FontStyle": 0, "Disabled": false, "Priority": 2}, {"Id": "3a31a518-df2a-4080-91d3-1b7c06cde33a", "Name": "disableKpiEditing", "KPIId": "8b4ab946-7ade-4e1f-a579-5cd10d835180", "ConditionKPIId": "04624e9f-426b-4969-91c7-b6edd57eba30", "BackColor": null, "FontColor": null, "FontStyle": 0, "Disabled": true, "Priority": 4}, {"Id": "a1fa5ca5-0733-442d-8036-1de37671f210", "Name": "highlightCombinationToAvoidInOutOfGuideline", "KPIId": "44664f1a-f8b6-40f7-a0eb-a4c9fd1e0457", "ConditionKPIId": "8b977a54-806e-4179-8e4e-a9e804538c18", "BackColor": -1768444.0, "FontColor": null, "FontStyle": 0, "Disabled": false, "Priority": 1}, {"Id": "e5cb5772-c786-4e09-b9b4-2d45492c0722", "Name": "shelfPriceVisualState", "KPIId": "850e96db-5269-4a0e-9c63-355e985b1ab8", "ConditionKPIId": "a374d13e-fa75-4049-bf40-f0c00926a868", "BackColor": null, "FontColor": -5043950.0, "FontStyle": 0, "Disabled": true, "Priority": 1}, {"Id": "655950e2-da7b-49c2-a659-40ab944a9a1b", "Name": "GreenCombinationToRecommend", "KPIId": "1ca862eb-4ab1-49bd-97fe-9b15e4f9d1ae", "ConditionKPIId": "84b835b0-8b35-46b1-bf6e-edbaddf08631", "BackColor": -11542246.0, "FontColor": null, "FontStyle": 0, "Disabled": false, "Priority": 2}, {"Id": "a51b00a5-dbbc-46df-a494-42cc81c63b40", "Name": "agregateHighlightRed", "KPIId": "1ca862eb-4ab1-49bd-97fe-9b15e4f9d1ae", "ConditionKPIId": "7983cf55-158d-4a0e-9ac0-2ced594a5c8f", "BackColor": -1768444.0, "FontColor": null, "FontStyle": 0, "Disabled": false, "Priority": 1}, {"Id": "b1a1b893-2540-4cb5-8433-4c9f9eff5ce9", "Name": "EmptyMinBudgetedPromoprice", "KPIId": "12e70200-28fc-49cf-9c74-9a4f261265dc", "ConditionKPIId": "32cb9855-2ed4-4c75-9d07-cbdb3b23828c", "BackColor": -3598.0, "FontColor": null, "FontStyle": 0, "Disabled": false, "Priority": 1}, {"Id": "cb335eef-74b7-4a47-bc35-4d1a0513f8c9", "Name": "highlightGreenPromotionalTypeCheckGuideline", "KPIId": "5dcb5331-5bb3-409d-86eb-c3639b7911aa", "ConditionKPIId": "8be28b7e-0cef-4c84-8aa1-9a767d95a6cc", "BackColor": -11542246.0, "FontColor": null, "FontStyle": 0, "Disabled": false, "Priority": 2}, {"Id": "ae977d75-123a-4a52-965a-5ac24e81f48a", "Name": "highlightGreenCombinationToRecommend", "KPIId": "d96ad067-bf8a-46ac-a2eb-65ad65d48aac", "ConditionKPIId": "84b835b0-8b35-46b1-bf6e-edbaddf08631", "BackColor": -11542246.0, "FontColor": null, "FontStyle": 0, "Disabled": false, "Priority": 1}, {"Id": "a315f222-d5b9-4fff-8e35-5ec1cfb447cb", "Name": "disableKpiEditing", "KPIId": "abc4773a-5d07-40b1-b3ac-b4d99f073bb7", "ConditionKPIId": "04624e9f-426b-4969-91c7-b6edd57eba30", "BackColor": null, "FontColor": null, "FontStyle": 0, "Disabled": true, "Priority": 1}, {"Id": "7451d6b6-0a76-4df3-9d82-63b0abdfa6d4", "Name": "RedHighlight", "KPIId": "8b4ab946-7ade-4e1f-a579-5cd10d835180", "ConditionKPIId": "dae382bc-79f0-46c7-8f11-4a586ab10f0a", "BackColor": null, "FontColor": -3407615.0, "FontStyle": 1, "Disabled": false, "Priority": 5}, {"Id": "90e4b309-6a91-4ecc-bf89-93e4707ef067", "Name": "disableKpiEditing", "KPIId": "f50d3cb0-0bdc-4b15-af0d-c70728452c88", "ConditionKPIId": "04624e9f-426b-4969-91c7-b6edd57eba30", "BackColor": null, "FontColor": null, "FontStyle": 0, "Disabled": true, "Priority": 1}, {"Id": "33446fa7-9921-4e1b-88e0-a14668e7061e", "Name": "Highlight_Zero_And_Disabled", "KPIId": "8b4ab946-7ade-4e1f-a579-5cd10d835180", "ConditionKPIId": "4f5f0a72-4185-4e5f-9374-f19f059c2962", "BackColor": -3598.0, "FontColor": null, "FontStyle": 0, "Disabled": true, "Priority": 1}, {"Id": "e43af9b9-7a24-4427-bf24-aae77b371c67", "Name": "EmptyListingCustomerPriceAutomatically", "KPIId": "4c6d1180-5336-4e2c-800c-e0b3751a1733", "ConditionKPIId": "6e560050-41bb-4ed6-98ca-d989bb8421e6", "BackColor": -3598.0, "FontColor": null, "FontStyle": 0, "Disabled": false, "Priority": 1}, {"Id": "a272ad68-c6d6-411b-ae17-c1f1beb900a3", "Name": "highlightGreenCombinationToAvoidInOutOfGuideline", "KPIId": "44664f1a-f8b6-40f7-a0eb-a4c9fd1e0457", "ConditionKPIId": "588add38-617e-4324-8c2c-bd283c058b43", "BackColor": -11542246.0, "FontColor": null, "FontStyle": 0, "Disabled": false, "Priority": 2}, {"Id": "a1de3c01-5775-4449-8d47-cea7ed2a5f23", "Name": "highlightRedPromotionalTypeCheckGuideline", "KPIId": "5dcb5331-5bb3-409d-86eb-c3639b7911aa", "ConditionKPIId": "208b6a13-d70a-4764-aac8-772a2470dc22", "BackColor": -1768444.0, "FontColor": null, "FontStyle": 0, "Disabled": false, "Priority": 1}, {"Id": "881f9b51-1466-44ec-b2e2-dedb066c16d6", "Name": "disableKpiEditing", "KPIId": "850e96db-5269-4a0e-9c63-355e985b1ab8", "ConditionKPIId": "04624e9f-426b-4969-91c7-b6edd57eba30", "BackColor": null, "FontColor": null, "FontStyle": 0, "Disabled": true, "Priority": 2}, {"Id": "178c361e-1633-42e9-a543-e4dca2951743", "Name": "disableKpiEditing", "KPIId": "d06fb36d-522a-4bcf-b231-7a3cdef71366", "ConditionKPIId": "04624e9f-426b-4969-91c7-b6edd57eba30", "BackColor": null, "FontColor": null, "FontStyle": 0, "Disabled": true, "Priority": 1}, {"Id": "0eabf391-8ae6-4a6a-bd1e-f82c0ccf3a0f", "Name": "mostFrequentPromoShelfPriceGuideline", "KPIId": "850e96db-5269-4a0e-9c63-355e985b1ab8", "ConditionKPIId": "7550f4e0-eb14-4e19-8330-e9379733313e", "BackColor": null, "FontColor": -5502702.0, "FontStyle": 1, "Disabled": false, "Priority": 3}, {"Id": "6a2d7652-ec7e-4928-8b27-fe9188e6af9c", "Name": "promoPriceProposalManuallyVisualState", "KPIId": "8b4ab946-7ade-4e1f-a579-5cd10d835180", "ConditionKPIId": "f4bff778-2e52-4a39-9c17-3eb70e8105cb", "BackColor": null, "FontColor": -3407615.0, "FontStyle": 0, "Disabled": true, "Priority": 3}], "cnfg.kpi.csv": [{"Id": "25cbd492-9f69-4a3d-a064-01ba63bbcb83", "Name": "kpi_other_baseline", "Type": 0, "ReadKPIConditionMetadataId": "e411ab86-406b-463c-840b-5942778151ab", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 2.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "f3490581-61d6-4c6a-8a36-024a3bece1c4", "Name": "kpi_ACT_Volume_index", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    decimal denominator = Products.Sum(p => p.kpi_Baseline_Product_calc);\n\n    if (denominator != 0)\n    {\n        result = Products.Sum(p => p.kpi_sell_out_manually) / denominator * 100 - 100;\n    }\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "366c8e7e-a976-4f8a-b297-02f8e75a12f7", "Name": "kpi_ACT_Sales_Margin", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_ActSalesMarginSKU);\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "f431191b-1e4c-4609-a3d2-037532517f2b", "Name": "kpi_index", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result;\n\nif ((decimal)kpi_baseline != 0)\n{\n    result = ( (decimal)kpi_promo_total_volume_plan /  (decimal)kpi_baseline) * 100 - 100;\n}\nelse\n{\n    result = 0; // або будь-яке інше значення, яке відповідає логіці вашої програми\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "d0d4f40f-61f1-456b-9be0-03b2b08d3442", "Name": "kpi_DoNotChangePrice", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\n\n// Перевіряємо умови\nif (kpi_DirectDiscountPerSKU == true && (kpi_Promo_price_proposal_manually == null || kpi_Promo_price_proposal_manually == 0))\n{\n    result = 1; // Якщо знижка увімкнена і ціна відсутня, повертаємо 1\n}\nelse\n{\n    result = 0; // В іншому випадку повертаємо 0\n}\n\nreturn result;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "a000ff52-c6c6-435c-b0db-04280079bee8", "Name": "kpi_cf_Product_Brand", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": " \nvar productBrand = Product.ProductInfo.CustomFields.FirstOrDefault(cf => cf.Name == \"cf_Product_Brand\")?.Value?.ToString();\n\nif (productBrand == null)\n{\n    return \"-\"; // Повертаємо значення за замовчуванням, якщо значення null\n}\n\nreturn productBrand;\n ", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 4}, {"Id": "8759c670-0030-4ff1-afcf-06975bbf4ac9", "Name": "kpi_InOutGuideline", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "8f256c85-1a85-46cd-8307-080c59cad3f4", "Name": "kpi_SalesMargin_L9", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nvar grP = Activity.Products\n    .GroupBy(p => p.Product.ProductInfo.CustomFields.FirstOrDefault(cf => cf.Name == \"cf_Product_Planning_Base_Label\")?.Value?.ToString())\n    .Select(g => new \n    {\n        g.Key,\n        NetRevenueL9 = g.Average(p => p.kpi_Net_Revenue_L9),\n        BaselineSum = g.Sum(p => p.kpi_Baseline_Product_calc),\n        PromoUpliftSum = g.Sum(p => p.kpi_Promo_Uplift_KAM),\n        CogsPromo = g.Average(p => p.kpi_cogs_promo)\n    })\n    .ToList();\nvar groupData = grP.FirstOrDefault(g => g.Key == Product.ProductInfo.CustomFields\n    .FirstOrDefault(cf => cf.Name == \"cf_Product_Planning_Base_Label\")?.Value?.ToString());\nif (groupData != null)\n    result = groupData.NetRevenueL9 - (groupData.BaselineSum + groupData.PromoUpliftSum) * groupData.CogsPromo;\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "588585cf-59a6-4657-960f-08bbf5763dd4", "Name": "kpi_WHS_Off_invoice", "Type": 0, "ReadKPIConditionMetadataId": "52fbf9e3-ba8f-4c68-95f0-d0e7f537f193", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 2.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "ca40e0a0-9e06-436b-9992-0baaa778d9f3", "Name": "kpi_CombinationToRecommendInOutOfGuideline", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 2, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "93c43aeb-867b-48f2-8e0a-0c3c17fbf0fa", "Name": "kpi_InvestmentPromoSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\n    result = kpi_VariablePromoSKU + kpi_FixedInvestment_KAM;\nreturn result;  ", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "a4620180-c52d-41da-baf9-0c770a638da0", "Name": "kpi_A_transport_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "if (Products.Count() >0) {\nreturn\tProducts.Average(p => p.kpi_transport_promo);\n}\nreturn 0;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "b18cf153-71f6-4921-9978-101b4f5bde67", "Name": "kpi_SFA_MM_BW", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return kpi_SFA_MM_promo-kpi_regular_baseline;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "9f12f35f-9830-4935-8af7-104b25587d03", "Name": "kpi_ACT_ROPI_price_shelf_BW", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return kpi_ACT_investment_total_promo != 0 \n    ? kpi_GCM_total_BW / kpi_ACT_investment_total_promo * 100 \n    : 0;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "67514284-8e2d-4002-9013-10da455bf4e5", "Name": "kpi_promo_total_volume_plan", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "\ndecimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_PromoVolumePlanSKU);\n}\nreturn result;", "Description": "auto-calculation is described in promo product KPI: Baseline + PromoUplift (automatically) from  Promo_Product_KPIs.\t\n", "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "d785974a-6960-4d01-b270-134f924a66ef", "Name": "kpi_ACT_GCM_total_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return \n//kpi_GCM_price_shelf_promo * kpi_promo_total_volume_fact   -  Products.Sum(p => p.kpi_kpi_fixed_investment);\n\n\nkpi_GCM_price_shelf_promo * (kpi_baseline + Products.Sum(p => p.kpi_Promo_Uplift_KAM))   - Products.Sum(p => p.kpi_kpi_fixed_investment);", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "722754d6-d4d1-4579-805a-152ecbba251d", "Name": "kpi_UpliftCalc_SecPlace", "Type": 0, "ReadKPIConditionMetadataId": "ed5f6f42-b1d5-49f9-8afd-b8013a8008b1", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 4.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "8ffb345d-53f3-4fee-9020-1602a168d33c", "Name": "kpi_ACTVariablePromoSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\n    result = kpi_sell_out_manually * kpi_Promo_price_proposal_manually * (kpi_rebatePromoBonus/100);\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "9282333e-6e27-4d7e-aa12-16c352764a52", "Name": "kpi_SellIn", "Type": 0, "ReadKPIConditionMetadataId": "743e6654-00c0-41ff-b820-85fd68f97c5c", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 0.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "a498ac12-a385-4d9f-96b1-178f89fb82b7", "Name": "kpi_SPL_price_automatically", "Type": 0, "ReadKPIConditionMetadataId": "536e1899-07cc-456a-ade9-36f9ad2dc0bd", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 1.0, "ReadKPIAggregationType": 2.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "15d56b03-bb8d-424f-8956-17d21e953a30", "Name": "kpi_InOutOfGuidline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "if (Activity.cf_UnsavedNew is true)\n{\nreturn false;\n}\nreturn !kpi_InOutGuideline;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 4, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "9aa4172e-2b1d-47d9-aa8e-186467196764", "Name": "kpi_promotional_index", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result;\n\nif ((decimal)kpi_regular_baseline != 0)\n{\n    result = ((decimal)kpi_promotional_promo\t/ (decimal)kpi_regular_baseline ) *100;\n}\nelse\n{\n    result = 0; // або будь-яке інше значення, яке відповідає логіці вашої програми\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "fa76dbc8-85ab-47ff-874a-1b5242d7d5ff", "Name": "kpi_ProductCode", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "var productCode = Product.ProductInfo?.Code;\n\nif (productCode == null)\n{\n    return \"-\"; // Return default value if productCode is null\n}\n\nreturn productCode;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 4}, {"Id": "cb89a801-43d1-4132-9b61-1bcc7fa8637c", "Name": "kpi_A_WHS_Off_invoice", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "if (Products.Count()>0){\nreturn\tProducts.Average(p => p.kpi_WHS_Off_invoice);\n}\nreturn 0;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "893c36fc-b5e0-45c5-b4c0-1c56309ad1ec", "Name": "kpi_variable_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_VariablePromoSKU);\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "ec19abbe-3571-4308-ad84-1cd05a59ed16", "Name": "kpi_NetRevenueSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nresult = (kpi_Baseline_Product_calc + kpi_Promo_Uplift_KAM) * \n             (kpi_Promo_price_proposal_manually * (1 - kpi_rebatePromoBonus / 100)) - \n             kpi_FixedInvestment_KAM;\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "8dfc3e94-ba11-46db-90d1-1ea3fb972d98", "Name": "kpi_Sales_Margin", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_SalesMarginSKU);\n}\nreturn result;\n\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "296ee2ff-d503-44bf-88aa-1f2bb7d579c5", "Name": "kpi_skuShareKpiEdit", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "9764bceb-8e51-41e2-a9fa-1f8f3653297c", "Name": "kpi_SalesMarginSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nresult = kpi_NetRevenueSKU - (kpi_Baseline_Product_calc + kpi_Promo_Uplift_KAM) * kpi_cogs_promo;\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "b095b056-37f0-45e4-82bc-2228eacb78f5", "Name": "kpi_FiFOdaysFoActSales_SelIn", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 1}, {"Id": "d962b723-d73e-4ec1-8aa7-22b27707c211", "Name": "kpi_Manual_Adjustment_VBB", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 3, "HierarchyAggregationType": 1, "DistributionKPIId": "296ee2ff-d503-44bf-88aa-1f2bb7d579c5", "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "d168682b-559a-4313-8848-23b34dfac62f", "Name": "kpi_ProductStatusMovementApproval", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "if ( kpi_Promo_price_proposal_manually < kpi_Min_Budgeted_Promo_price ) {\nreturn 0;} else {return 1;}\n \n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 1}, {"Id": "efb94b12-b97b-4a50-a331-26a80b445535", "Name": "kpi_InOutGuideline_header", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return \t Products.Count == Products.Count(p => p.kpi_InOutGuideline == true) ? 1 : 0; ;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "717818f5-d64f-4ed7-9d3e-2716fc96e277", "Name": "kpi_GCMBaselineSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\n\nresult = kpi_Baseline_Product_calc * \n         (\n            (\n                kpi_Listing_customer_price_automatically -\n                (kpi_Listing_customer_price_automatically * kpi_rebatePromoBonus / 100) -\n                kpi_cogs_promo\n            ) - \n            kpi_other_promo - \n            kpi_transport_promo - \n            kpi_WHS_promo\n         );\n\nreturn result;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "60fb6bdb-926d-4485-9447-27527a420ddc", "Name": "kpi_Copy_Text", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 2, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 4}, {"Id": "7daf5436-18cb-47a4-8510-2b9eabd2b953", "Name": "kpi_CodeOfMaterialPricingGroup", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "var Material_Group_Label= Product.ProductInfo.CustomFields.FirstOrDefault(cf => cf.Name == \"cf_Material_Group_Label\")?.Value?.ToString();\n\nif (Material_Group_Label== null)\n{\n    return \"-\"; // Повертаємо значення за замовчуванням, якщо значення null\n}\n\nreturn Material_Group_Label;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 4}, {"Id": "c0cec776-1d4f-4892-963d-2ced043c10f0", "Name": "kpi_ACT_GCM_total_shelf_index", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result;\n\nif ((decimal)kpi_GCM_total_shelf_baseline != 0)\n{\n    result = ((decimal)kpi_ACT_GCM_total_shelf_promo  / (decimal)kpi_GCM_total_shelf_baseline)*100;\n}\nelse\n{\n    result = 0; // або будь-яке інше значення, яке відповідає логіці вашої програми\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "7983cf55-158d-4a0e-9ac0-2ced594a5c8f", "Name": "kpi_highlightInOutOfGuidlineAgregate", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "\nif (Activity.cf_UnsavedNew is true)\n{\n    return false; // Повертаємо 1, якщо Activity.cf_UnsavedNew дорівнює true\n}\n\n// Перевіряємо KPI для кожного продукту\nif (!kpi_mostFrequentPromoShelfPriceGuideline ||  \n    !kpi_PromotionalTypeCheckGuideline ||  \n    !kpi_CombinationToAvoidInOutOfGuideline) \n{\n    return true; // Якщо хоча б один KPI дорівнює false, повертаємо 1\n}\n\nreturn false; // Якщо всі KPI дорівнюють true, повертаємо 0", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "c4e36867-68c0-43ef-9b6f-2d3c339fa08e", "Name": "kpi_Main_Forecast_VBB", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": "var isGroup1 = ClientDetails.CustomFields.FirstOrDefault(cf => cf.Name == \"cf_IsGroup1\")?.Value;\nvar period = ObjectSpace.GetObjectByKey<Period>(RelatedPeriodId);\n\nif ((isGroup1 != null && (bool)isGroup1 == true) || period.EndDate.Date < DateTime.Now.Date)  \n{  \n    return kpi_ForecastPromoVolume + kpi_ForecastBaseline + kpi_Manual_Adjustment_VBB + kpi_Forward_Buy;  \n}  \nelse  \n{  \n    return kpi_ForecastUnfoldedBaseline + kpi_Manual_Adjustment_VBB + kpi_Forward_Buy;  \n}", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "80f77dd0-8b9f-47be-9469-2e47fa9970b1", "Name": "kpi_Promo_Volume_Short", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": "b7a89f8d-24c9-4fdf-858e-9f99eb8b42be", "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "return new[] {\"📝 Draft\", \"❌ Canceled\", \"🚫 Not Approved\"}.Contains(Activity.State.Name.ToString()) ? 0 : kpi_Promo_Uplift_KAM;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": true, "RelevantPeriodStart": "ShipmentStartDate", "RelevantPeriodEnd": "ShipmentEndDate", "DataType": 0}, {"Id": "0f673ae7-31fb-49c7-ade3-2eaca5468ddf", "Name": "kpi_frcGrothRate", "Type": 0, "ReadKPIConditionMetadataId": "665574e6-8bde-47c5-ae35-30a5ac8a0b6c", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "0d0a32c8-3815-409f-989f-30dbfb90077c", "Name": "kpi_PromoPriceManuallyAdjVsMinBugetedPromoPrice", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nresult = kpi_Promo_price_proposal_manually - kpi_Min_Budgeted_Promo_price;\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "3cebe90d-6113-4d6d-83e6-32abbd567d45", "Name": "kpi_ActGrossMarginSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nresult = (decimal) (kpi_ActSalesMarginSKU - (kpi_sell_out_manually * (kpi_transport_promo+kpi_other_promo+kpi_WHS_promo)));\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "818b7e72-54ac-4338-9187-33bc0bd9fb86", "Name": "kpi_promotional_BW", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return kpi_promotional_promo\t- kpi_regular_baseline;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "f0ddcdf4-9887-415e-aff6-3527c2410ba4", "Name": "kpi_GCM_price_shelf_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return kpi_Min_Budgeted_Promo_price_total *(1-kpi_A_kpi_rebatePromoBonus /100) -kpi_A_cogs_promo\n-kpi_A_other_promo -kpi_A_transport_promo - kpi_A_WHS_promo ;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "850e96db-5269-4a0e-9c63-355e985b1ab8", "Name": "kpi_Shelf_price", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": "Візуальна поведінка KPI налаштовується через три логічні KPI з відповідними пріоритетами:\n\nkpi_shelfPriceVisualState – пріоритет 1\nЯкщо true → kpi_Shelf_price буде задізейблений та підсвічений червоним\nЯкщо false → переходимо до наступного правила\n\nkpi_disableKpiEditing – пріоритет 2\nЯкщо true → kpi_Shelf_price буде задізейблений без підсвітки\nЯкщо false → переходимо до наступного правила\n\nkpi_highlightMostFrequentPromoShelfPriceGuideline – пріоритет 3\nЯкщо true → kpi_Shelf_price буде підсвічений червоним, але доступний для редагування\nЯкщо false → KPI відображається без змін", "HierarchyDistributionType": 2, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "1a99aca0-3ab6-4838-9cce-3589b09e7d5b", "Name": "kpi_GRPs", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "3c53b5d3-1ab5-4144-8e29-36197ef1fb71", "Name": "kpi_ACT_kpi_variable_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_ACTVariablePromoSKU);\n}\nreturn result;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "e1345602-d821-4a52-9193-3dfeecd956ec", "Name": "kpi_ForecastUnfoldedBaseline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": "var isGroup1 = ClientDetails.CustomFields.FirstOrDefault(cf => cf.Name == \"cf_IsGroup1\")?.Value;\nvar period = ObjectSpace.GetObjectByKey<Period>(RelatedPeriodId);\n\nif ((isGroup1 != null && (bool)isGroup1 == true) ||  period.EndDate.Date < DateTime.Now.Date)  \n{  \n    return 0;  \n}  \nelse  \n{  \n    return kpi_UnfoldedBaseline + kpi_ForecastBaseline;  \n}", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "cf9980bf-b56f-4b1e-8d03-3e6d253a52be", "Name": "kpi_investment_total_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_InvestmentPromoSKU);\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "f4bff778-2e52-4a39-9c17-3eb70e8105cb", "Name": "kpi_promoPriceProposalManuallyVisualState", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "bool isDisabled = Activity.cf_DisableKpiPromo == true;\nbool isHighlighted = false;\n\nvar kpiValues = new Dictionary<Guid, bool>\n{\n    { Guid.Parse(\"47C747D8-BA01-432A-A320-B6F7DD7D0633\"), true },\n    { Guid.Parse(\"7013AF5D-F824-4636-AB3E-042168874629\"), true },\n    { Guid.Parse(\"3E66F51F-C580-4B7F-8176-8AD2B4B246A9\"), true },\n    { Guid.Parse(\"298B9B43-A604-4DBD-898E-8D0BC78C675C\"), true },\n    { Guid.Parse(\"7A9B624D-67C1-4542-B46B-8ED69273464D\"), true },\n    { Guid.Parse(\"04563662-0556-441F-8E80-A74E595C7097\"), true },\n    { Guid.Parse(\"4AD51074-B227-4AFD-9092-AC37A7D18852\"), true },\n    { Guid.Parse(\"78041807-4A08-4C31-884E-FE3BDCFDEA45\"), true }\n};\n\nif (kpi_ExistingProduct == true && kpiValues.TryGetValue(Activity.MechanicId, out var kpiValue))\n{\n    isHighlighted = kpi_Promo_price_proposal_manually == 0 || \n                    kpi_Promo_price_proposal_manually < kpi_Min_Budgeted_Promo_price;\n}\n\nreturn isDisabled && isHighlighted;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "b6377cbb-6bb7-40f6-9690-3f04888df25a", "Name": "kpi_ACT_Gross_Margin", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_ActGrossMarginSKU);\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "b7786c29-4c8e-4875-acef-40ab4e9b2849", "Name": "kpi_PlannedBudget", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "b9c7eaf7-a9ce-4d9e-9b73-43cf23edc028", "Name": "kpi_ForecastPromoVolume", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": "var isGroup1 = ClientDetails.CustomFields.FirstOrDefault(cf => cf.Name == \"cf_IsGroup1\")?.Value;\nvar period = ObjectSpace.GetObjectByKey<Period>(RelatedPeriodId);\n \nif (period.EndDate.Date < DateTime.Now.Date)\n{\n    return kpi_frcPromoVolumePast > 0 ? kpi_frcPromoVolumePast : 0;\n}\nelse if (isGroup1 != null && (bool)isGroup1 == true && period.StartDate.Date > DateTime.Now.AddMonths(2).Date)\n{\n    return kpi_GrowthRate_tech * kpi_NumberOfPromotionsVBB;\n}\nelse\n{\n    return kpi_frcPromoVolumeShort;\n}", "Description": "Code before 23.07.2025 (past values taken directly from Promotion):\nvar isGroup1 = ClientDetails.CustomFields.FirstOrDefault(cf => cf.Name == \"cf_IsGroup1\")?.Value;\nvar period = ObjectSpace.GetObjectByKey<Period>(RelatedPeriodId);\n\nif (period.EndDate.Date < DateTime.Now.Date)  \n{  \n    return kpi_frcPromoVolumePast;  \n}  \nelse if (isGroup1 != null && (bool)isGroup1 == true && period.StartDate.Date > DateTime.Now.AddMonths(2).Date) \n{  \n    return kpi_GrowthRate_tech * kpi_NumberOfPromotionsVBB;  \n}\nelse\n{\n    return kpi_frcPromoVolumeShort;\n}\n", "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "4e33c67c-2672-40b9-854d-441f2b0ae5f4", "Name": "kpi_selectedGuideline", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 4}, {"Id": "f3e36af5-afb2-4278-acd5-44c00d319cc5", "Name": "kpi_SellIn_calc", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "return kpi_sell_In_manually;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "dae382bc-79f0-46c7-8f11-4a586ab10f0a", "Name": "kpi_Color_Mechanic", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "var mechanicId = Activity.MechanicId;\n\nvar kpiValues = new Dictionary<Guid, bool>\n{\n    { Guid.Parse(\"47C747D8-BA01-432A-A320-B6F7DD7D0633\"), true },\n    { Guid.Parse(\"7013AF5D-F824-4636-AB3E-042168874629\"), true },\n    { Guid.Parse(\"3E66F51F-C580-4B7F-8176-8AD2B4B246A9\"), true },\n    { Guid.Parse(\"298B9B43-A604-4DBD-898E-8D0BC78C675C\"), true },\n    { Guid.Parse(\"7A9B624D-67C1-4542-B46B-8ED69273464D\"), true },\n    { Guid.Parse(\"04563662-0556-441F-8E80-A74E595C7097\"), true },\n    { Guid.Parse(\"4AD51074-B227-4AFD-9092-AC37A7D18852\"), true },\n    { Guid.Parse(\"78041807-4A08-4C31-884E-FE3BDCFDEA45\"), true }\n};\n\n// Перевіряємо, чи mechanicId є в kpiValues\nif (kpiValues.TryGetValue(mechanicId, out var kpiValue))\n{\n    // Якщо kpi_Promo_price_proposal_manually == 0 АБО менше за kpi_Min_Budgeted_Promo_price → true\n    return kpi_Promo_price_proposal_manually == 0 || \n           (kpi_Promo_price_proposal_manually < kpi_Min_Budgeted_Promo_price);\n}\n\n// Якщо mechanicId немає в kpiValues → false\nreturn false;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 4, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "ae1bc6fc-b99a-4619-9d5e-4a7e3e53b595", "Name": "kpi_BaselineVBB", "Type": 0, "ReadKPIConditionMetadataId": "f730c85f-64a8-4dd8-9922-b3fac4ee8f4d", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "4b6e050e-25ce-44ba-8881-4b674f4651a8", "Name": "kpi_FiFOdaysFoActSales_SelOut", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 1}, {"Id": "e8eed1ab-bb5f-4fdc-81ce-4caad029b9a9", "Name": "kpi_SMM_SFA_MM_baseline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return\nkpi_regular_baseline *(1-kpi_A_kpi_rebatePromoBonus/100) - kpi_A_cogs_promo\n;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "4d11f32f-ea31-4b05-918a-4fafcbca9d8d", "Name": "kpi_ACTVolumeIndexSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\n\nif (kpi_Baseline_Product_calc != 0)\n{\n    result = (kpi_sell_out_manually / kpi_Baseline_Product_calc) * 100 - 100;\n}\nelse\n{\n    result = 0;\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "ff4ec5ee-2ca4-4f51-8201-50262301669f", "Name": "kpi_UpliftCalc_EDLP", "Type": 0, "ReadKPIConditionMetadataId": "6af44961-99df-4bb5-9c56-7ac357ed9525", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 4.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "bfb41446-91b3-45c0-839f-50c278b1ad45", "Name": "kpi_Actual_Volume", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "9e34452a-1db3-47cf-804e-514e84a170b8", "Name": "kpi_frcFactNumberOfPromo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": "080571f2-5016-457a-838e-c714bfb739d0", "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "var s=new DateTime(Activity.ShipmentStartDate.Year,Activity.ShipmentStartDate.Month,1);\nvar e=new DateTime(Activity.ShipmentEndDate.Year,Activity.ShipmentEndDate.Month,DateTime.DaysInMonth(Activity.ShipmentEndDate.Year,Activity.ShipmentEndDate.Month));\nvar d=DateTime.Now;\nvar f=new DateTime(d.Year,d.Month,1);\nvar m=f.AddMonths(2);\nvar l=new DateTime(m.Year,m.Month,DateTime.DaysInMonth(m.Year,m.Month));\nvar id=Activity.State.Id;\nif(Activity.ShipmentEndDate.Date<f)\n{\nif(\nid==Guid.Parse(\"9CA8D0BD-6AE8-48B3-8159-812584792B92\")||\nid==Guid.Parse(\"F13A0C48-B64A-4514-ADD1-E7C8C51B2C4B\")||\nid==Guid.Parse(\"7445ED05-1312-4375-838D-36DFC570EB7E\")\n)\n{\nreturn(e-s).Days+1;\n}\nelse\n{\nreturn 0;\n}\n}\nelse if(Activity.ShipmentEndDate.Date>=f&&Activity.ShipmentEndDate.Date<=l)\n{\nif(\nid==Guid.Parse(\"7445ED05-1312-4375-838D-36DFC570EB7E\")||\nid==Guid.Parse(\"B68C1C7C-BC4A-4F24-B1B2-E8F11EE15995\")||\nid==Guid.Parse(\"0029FC71-08E9-4981-A795-F64A7E28DAF1\")||\nid==Guid.Parse(\"ECE80A75-9A82-4C6C-A581-C36070AC0521\")||\nid==Guid.Parse(\"D03E181B-0D7C-4149-8DCE-3E7F0C8ECBD5\")\n)\n{\nreturn(e-s).Days+1;\n}\nelse\n{\nreturn 0;\n}\n}\nelse if(Activity.ShipmentEndDate.Date>l)\n{\nif(\nid==Guid.Parse(\"7445ED05-1312-4375-838D-36DFC570EB7E\")||\nid==Guid.Parse(\"B68C1C7C-BC4A-4F24-B1B2-E8F11EE15995\")||\nid==Guid.Parse(\"0029FC71-08E9-4981-A795-F64A7E28DAF1\")||\nid==Guid.Parse(\"ECE80A75-9A82-4C6C-A581-C36070AC0521\")||\nid==Guid.Parse(\"D03E181B-0D7C-4149-8DCE-3E7F0C8ECBD5\")\n)\n\t{\n\t\treturn(e-s).Days+1;\n\t}\n\telse\n\t{\n\t\treturn 0;\n\t}\n}\nreturn 0;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": true, "RelevantPeriodStart": "cf_NumberOfPromoStartDate", "RelevantPeriodEnd": "cf_NumberOfPromoEndDate", "DataType": 0}, {"Id": "0a4fc7e8-dc10-4f28-b14f-5367f0133554", "Name": "kpi_ACTInvestmentTotalPromoSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\n    result = kpi_ACTVariablePromoSKU + kpi_FixedInvestment_KAM;\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "dadb56b1-47d9-4115-a591-551461affb60", "Name": "kpi_GCMPlanBtl", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nresult = kpi_NetRevenueBtl - (kpi_cogs_promo + kpi_other_promo + kpi_transport_promo + kpi_WHS_promo);\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "bacb4557-e12b-4d01-b1d8-556267843f19", "Name": "kpi_promotional_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "\n if (Products.Count() != 0 ){\n\nreturn\tProducts.Average(p => p.kpi_Promo_price_proposal_manually\n);\n\n}\nelse{\nreturn 0;\n}", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "d2e299a7-0781-4151-b224-574faf19a6e1", "Name": "kpi_new", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "e8fd4c44-51d7-453e-9fc7-579640e8d8ce", "Name": "kpi_Copy_LIst", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 2, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 3}, {"Id": "e33d2d2a-b5be-4f2a-b61f-57e1abc7d300", "Name": "kpi_PromoVolumePlanSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\n    result = kpi_Baseline_Product_calc + kpi_Promo_Uplift_KAM;\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "f00be0a2-82d5-47ec-ba59-580dfcd44cd8", "Name": "kpi_ACT_Volume_BW", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_ActVolumeBWSKU);\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "8b4ab946-7ade-4e1f-a579-5cd10d835180", "Name": "kpi_Promo_price_proposal_manually", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 2, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "a82949ad-3124-4177-ab2f-5d0b88114357", "Name": "kpi_Guideline_KPI", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 2, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "1b1204f0-3f58-45e4-be73-5d78c44ef2cc", "Name": "kpi_WHS_baseline", "Type": 0, "ReadKPIConditionMetadataId": "e8e5677b-1f8c-408d-9dfd-645b8ec571c6", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 2.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "43e94bab-459a-48b4-81b6-62946a60e354", "Name": "kpi_Highlight_Zero_And_EnabledPProposalManually", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "bool isZero = kpi_Promo_price_proposal_manually == 0;\nbool isDisabled = Activity.cf_DisableKpiPromo == true;\n\nreturn isZero && !isDisabled;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "c6921fb1-ce72-4b84-819c-62cbf4637a7a", "Name": "kpi_GCM_promo_price_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return \nkpi_promotional_promo *(1-kpi_A_kpi_rebatePromoBonus/100)-kpi_A_cogs_promo-kpi_A_other_promo -kpi_A_transport_promo - kpi_A_WHS_promo;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "70a5a583-2f2e-462e-8bcb-6314306a4a19", "Name": "kpi_ForecastBaseline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": "var period = ObjectSpace.GetObjectByKey<Period>(RelatedPeriodId);\n\nif (period.EndDate.Date < DateTime.Now.Date)  \n{  \n    return kpi_BaselineVBB;  \n}  \nelse  \n{  \n    return kpi_BaselineVBB; \n}", "Description": "change before 23.07.2025 (Baseline for past period previously taken from actual sales calculated by Procedure (S.Zamler):\nvar period = ObjectSpace.GetObjectByKey<Period>(RelatedPeriodId);\n\nif (period.EndDate.Date < DateTime.Now.Date)  \n{  \n    return kpi_frcSKUSalesAsShare;  \n}  \nelse  \n{  \n    return kpi_BaselineVBB; \n}", "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "8c46c348-d156-4074-b6c0-64b621c1c08b", "Name": "kpi_ACT_Net_Revenue", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_ActNetRevenueSKU);\n}\nreturn result;", "Description": " ", "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "d96ad067-bf8a-46ac-a2eb-65ad65d48aac", "Name": "kpi_DisplayCombinationToRecommendGuideline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "return 0;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "e364fcdb-c3dd-41e5-9999-678371ea3315", "Name": "kpi_ACT_investment_total_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_ACTInvestmentTotalPromoSKU);\n      // result = kpi_ACT_kpi_variable_promo + Products.Sum(p => p.kpi_FixedInvestment_KAM);\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "bfdb0ed0-268b-46aa-a8ad-67991c288793", "Name": "kpi_UpliftCalc_Leaflet", "Type": 0, "ReadKPIConditionMetadataId": "1d73f32e-0c0d-4e4c-87b5-ace126f6e73a", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 4.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "600e2731-c2b5-4022-8368-6b48c1d0b4c4", "Name": "kpi_Discount_SPL", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result;\n\nif ((decimal)kpi_SPL_price_automatically != 0)\n{\n    result =  (1-  (decimal)kpi_Promo_price_proposal_manually /  (decimal)kpi_SPL_price_automatically ) *100;\n}\nelse\n{\n    result = 0; // або будь-яке інше значення, яке відповідає логіці вашої програми\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "c36f5330-3b79-4e1e-a85d-6b7a7a5bc3ec", "Name": "kpi_Min_Budgeted_Promo_price_total", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "if (Products.Count() != 0 ){\n\nreturn  Products.Average(p => p.kpi_Min_Budgeted_Promo_price\n);\n\n}\nelse{\nreturn 0;\n}", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "4a9522a7-0082-4bbc-867e-6c605024af92", "Name": "kpi_ProductVAT", "Type": 0, "ReadKPIConditionMetadataId": "028005ad-3c49-490f-9bca-55d1d01d16c6", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 1.0, "ReadKPIAggregationType": 3.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "40619500-6509-43cd-b33a-6cd0e9b5c785", "Name": "kpi_ShipmentDate", "Type": 0, "ReadKPIConditionMetadataId": "0ad97e30-8ace-4426-a43e-21ec6648e2c8", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 1.0, "ReadKPIAggregationType": 2.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "7bcdfeb7-73c3-4905-aaec-6dcd0eb333c7", "Name": "kpi_A_cogs_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "  if (Products.Count()>0){\nreturn\tProducts.Average(p => p.kpi_cogs_promo);\n}\nreturn 0;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "c767e784-fcab-4a79-be6e-6dd924f6df83", "Name": "kpi_SKUPenetrationByPromotion", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "510b67f3-9dbf-432a-80e9-6e3c296e935f", "Name": "kpi_frcPromoVolumePast", "Type": 0, "ReadKPIConditionMetadataId": "ccc3f49f-1cb8-4ff2-bf74-cc5b3a8fef5c", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "e8b48be5-eaaa-47e2-89ee-6e7ae2b0aea6", "Name": "kpi_Promo_Uplift_KAM_Intermediate_2", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "6d098f13-28d5-4db8-b099-6ef4968cab93", "Name": "kpi_GCM_total_shelf_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_GCMShelfPromoSKU);\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "7495b887-d611-4bf5-bd38-7015eaed3fbf", "Name": "kpi_factNumberOfPromo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": "var period = ObjectSpace.GetObjectByKey<Period>(RelatedPeriodId);\n\nif (period == null)\n    return 0;\n\nvar daysInMonth = DateTime.DaysInMonth(period.StartDate.Year, period.StartDate.Month);\n\nif (daysInMonth == 0)\n    return 0;\n\nreturn kpi_factNumberOfPromoRead / daysInMonth;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "82bdafa3-8fb9-43d9-8436-7033710fe559", "Name": "kpi_WHS_promo", "Type": 0, "ReadKPIConditionMetadataId": "9dc3917f-5026-44d7-9623-c207c7e5b480", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 2.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "61647ec0-364c-4d66-9bd4-70398a7b395d", "Name": "kpi_TextTstGuideline", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 4}, {"Id": "a1176b3e-dba4-466d-8b0e-7117ba6c8c11", "Name": "kpi_ACT_ROPI_promo_price_BW", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result;\n\nif ((decimal)kpi_ACT_investment_total_promo != 0)\n{\n   // result =  ((decimal)kpi_ACT_GCM_total_BW /(decimal)kpi_ACT_investment_total_promo )*100;\nresult =  ((decimal)kpi_ACT_GCM_total_BW /(decimal)kpi_ACT_investment_total_promo )*100;\n\n}\nelse\n{\n    result = 0; // або будь-яке інше значення, яке відповідає логіці вашої програми\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "4825a06c-9f2a-4c31-b221-72dcfc18dded", "Name": "kpi_NetRevenueBtl", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nif (kpi_TotalPlanVolumePromotion == 0)\n{\n   result = (decimal)kpi_Promo_price_proposal_manually * (1 - kpi_rebatePromoBonus / 100) \n         - (kpi_FixedInvestment_KAM);\n}\nelse\n{\nresult = (decimal)kpi_Promo_price_proposal_manually * (1 - kpi_rebatePromoBonus / 100) \n         - (kpi_FixedInvestment_KAM / kpi_TotalPlanVolumePromotion);\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "0b52c7e3-8602-42dd-a14d-7324ac6e34fe", "Name": "kpi_DirectDiscountPerSKU", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 2, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "5e5a5f93-c15b-4044-8b0a-73e69b0e328b", "Name": "kpi_A_rebateBaseline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "  if (Products.Count()>0){\nreturn\tProducts.Average(p => p.kpi_rebateBaseline );\n}\nreturn 0;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "7de15a97-620c-4712-8f11-74335e90df80", "Name": "kpi_ACT_GCM_total_shelf_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "\nreturn \n//kpi_GCM_price_shelf_promo * kpi_promo_total_volume_fact -Products.Sum(p => p.kpi_kpi_fixed_investment);\nkpi_GCM_price_shelf_promo * kpi_promo_total_volume_fact - kpi_Fixed_Investment_header ; ", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "a3376192-e5a5-4bf9-8eee-745a1b1d267b", "Name": "kpi_ROPI_promo_price_BW", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result;\n\nif ((decimal)kpi_investment_total_promo != 0)\n{\n    result =  ((decimal)kpi_GCM_total_BW /(decimal)kpi_investment_total_promo )*100;\n}\nelse\n{\n    result = 0; // або будь-яке інше значення, яке відповідає логіці вашої програми\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "d6a34985-13d3-499e-9993-75d81dbc5aa3", "Name": "kpi_GCM_promo_price_baseline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return kpi_SMM_SFA_MM_baseline-kpi_A_other_promo-kpi_A_transport_promo-kpi_A_WHS_promo\n;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "9b04d574-23e9-4f78-b906-76a3d0895d1a", "Name": "kpi_Baseline_Product", "Type": 0, "ReadKPIConditionMetadataId": "ccebb45d-846b-4e46-85c3-80c4c2722236", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 2.0, "ReadKPIAggregationType": 0.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "208b6a13-d70a-4764-aac8-772a2470dc22", "Name": "kpi_highlightPromotionalTypeCheckGuideline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "if (Activity.cf_UnsavedNew is true)\n{\n    return false;\n}\n\nif (kpi_ExistingProduct == false)\n{\n    return false;\n}\nreturn !kpi_PromotionalTypeCheckGuideline;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "43e71edb-0f49-413e-bce0-77f6a307840b", "Name": "kpi_SKUSAPCode", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "if (Activity.cf_SAP_INDENTIFICATION == 1)\n{\n    // Повертаємо значення cf_SAP_SKU_Code1 для продукту\n    var result = Product.ProductInfo.CustomFields\n        .FirstOrDefault(cf => cf.Name == \"cf_SAP_SKU_Code2\")?.Value;\n\n    return result != null ? result.ToString() : string.Empty; // Повертаємо рядок або порожній рядок, якщо результат null\n}\nelse if (Activity.cf_SAP_INDENTIFICATION == 2)\n{\n    // Повертаємо значення cf_SAP_SKU_Code2 для продукту\n    var result = Product.ProductInfo.CustomFields\n        .FirstOrDefault(cf => cf.Name == \"cf_SAP_SKU_Code1\")?.Value;\n\n    return result != null ? result.ToString() : string.Empty; // Повертаємо рядок або порожній рядок, якщо результат null\n}\nelse\n{\n    // У разі, якщо cf_SAP_INDENTIFICATION має некоректне значення\n    return string.Empty; // Повертаємо порожній рядок\n}\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 4}, {"Id": "d06fb36d-522a-4bcf-b231-7a3cdef71366", "Name": "kpi_FixedInvestment_KAM", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 3, "HierarchyAggregationType": 1, "DistributionKPIId": "ad8443ec-9e0a-44fe-96a8-cc3cc656ee59", "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "d0e5efbb-e851-4456-89bd-7a8fb6df8bcd", "Name": "kpi_ShelfDummy", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\ndecimal denominator = kpi_ProductVAT == null ? 1 : 1 + kpi_ProductVAT / 100;\n        if (denominator != 0)\n        {\n            result = (decimal) kpi_Shelf_price / denominator;\n        }\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "85d7868e-b993-44e1-9c1d-7c0cdbe28ceb", "Name": "kpi_GCM_promo_price_BW", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return kpi_GCM_promo_price_promo - kpi_GCM_promo_price_baseline;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "52201938-46dd-4672-9776-7c42ab1c5e04", "Name": "kpi_Discount_customer_price", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "\ndecimal result;\n\nif ((decimal)kpi_Listing_customer_price_automatically != 0)\n{\n    result =  (1- (decimal)kpi_Promo_price_proposal_manually / (decimal)kpi_Listing_customer_price_automatically)  * 100;\n}\nelse\n{\n    result = 0; // або будь-яке інше значення, яке відповідає логіці вашої програми\n}\n\nreturn result;\n ", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "c2620d76-5d46-4259-8256-7d07ecede44c", "Name": "kpi_PromoPriceManuallyAdjVsMinBugetedPromoPricePct", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nif (kpi_Min_Budgeted_Promo_price == 0)\n{\n    result = 0;\n}\nelse\n{\nresult = kpi_PromoPriceManuallyAdjVsMinBugetedPromoPrice/kpi_Min_Budgeted_Promo_price*100;\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "22d33f9b-0aba-4c19-80b9-7df23ba6e9fc", "Name": "kpi_A_kpi_rebatePromoBonus", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": " if (Products.Count()>0){\nreturn\tProducts.Average(p => p.kpi_rebatePromoBonus);\n}\nreturn 0;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "a70d86ef-c4e6-4e1d-be76-7f194507471e", "Name": "kpi_GCM_total_shelf_baseline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_GCMShelfBaselineSKU);\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "126c290c-f2aa-4d3f-a77a-7f89dd0485fb", "Name": "kpi_ROPI_ActivityProducts", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\ndecimal denominator = kpi_FixedInvestment_KAM + (kpi_TotalPlanVolumePromotion * (kpi_Listing_customer_price_automatically - kpi_Promo_price_proposal_manually)*(1 - kpi_rebatePromoBonus / 100));\n\n// Перевіряємо, чи знаменник не дорівнює 0\nif (denominator != 0)\n{\n    result = (decimal) ((kpi_GCMPlanBtl * kpi_TotalPlanVolumePromotion) \n             - (kpi_Baseline_Product_calc * \n                (kpi_Listing_customer_price_automatically * (1 - kpi_rebatePromoBonus / 100)\n                - (kpi_cogs_promo + kpi_other_promo + kpi_transport_promo + kpi_WHS_promo))))   * 100    / denominator;\n}\n\nreturn result;\n\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "1629b31a-63bb-49f5-9236-80a97b74838c", "Name": "kpi_promo_total_volume_fact", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "if (Products.Count() != 0 ){\n\nreturn   (decimal) Products.Sum(p => p.kpi_sell_out_manually) ;\n\n}\nelse{\nreturn 0;\n}", "Description": "111", "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "4ce869de-ccca-4eec-96e6-8725ce074c06", "Name": "kpi_ExtraPromoPc", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 2, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "f61bf356-0257-4ced-8328-873bcc0dfdd6", "Name": "kpi_sell_out_manually", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 3, "HierarchyAggregationType": 1, "DistributionKPIId": "b45c13b3-41c1-4737-83c8-a9ba29a4d574", "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "bf3cd3e4-7505-44fb-9144-87d507324e76", "Name": "kpi_Promo_Uplift_automatically", "Type": 0, "ReadKPIConditionMetadataId": "69142483-c11c-4ffa-9fd0-3af56dcca9c8", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 0.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": "KPI старий. Не використовується. Замість нього kpi_UpliftCalc_Mechanic (Promo objem Calc - návrh (ks))", "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "e0415bb7-bca1-48b0-898f-883aa9648eda", "Name": "kpi_Promo_Uplift_KAM_Intermediate", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nvar groupedProductsWithZeroSum = Activity.Products\n    .Where(p => p.kpi_UpliftCalc_Mechanic != null)\n    .GroupBy(p => p.Product.ProductInfo.CustomFields.FirstOrDefault(cf => cf.Name == \"cf_Product_Planning_Base_Label\")?.Value?.ToString())\n    .Select(group => new \n    {\n        GroupKey = group.Key,        Products = group.ToList(),\n        SumUpliftCalcMechanic = group.Sum(p => p.kpi_UpliftCalc_Mechanic)\n    })\n    .Where(group => group.SumUpliftCalcMechanic == 0)\n    .Select(group => group.GroupKey) // Зберігаємо лише ключі груп\n    .ToList();\n\nvar productLabel = Product.ProductInfo.CustomFields.FirstOrDefault(cf => cf.Name == \"cf_Product_Planning_Base_Label\")?.Value?.ToString();\n\n    if (groupedProductsWithZeroSum.Contains(productLabel))\n    {\n        result = 1;\n    }\n    else\n    {\n        result = kpi_UpliftCalc_Mechanic;\n    }\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "88eafbef-508d-473f-9b79-88a3155b3ff9", "Name": "kpi_transport_promo", "Type": 0, "ReadKPIConditionMetadataId": "2e5db06d-47e4-4221-adb4-fbece684a762", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 2.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "447ab844-d672-49f4-af05-8a457d640072", "Name": "kpi_cogs_baseline", "Type": 0, "ReadKPIConditionMetadataId": "0c5615b2-11f4-4e6f-a740-f8053e3ff031", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 2.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "ef24632d-b51e-446f-9222-8a8e7f2d04c3", "Name": "kpi_GCMShelfBaselineSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\n    result = kpi_Baseline_Product_calc * ((kpi_Listing_customer_price_automatically - (kpi_Listing_customer_price_automatically*kpi_rebatePromoBonus/100)- kpi_cogs_promo) - kpi_other_promo - kpi_transport_promo - kpi_WHS_promo);\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "6ac89799-3f7c-4027-b71a-912c6dc798aa", "Name": "kpi_A_other_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "  if (Products.Count()>0){\nreturn\tProducts.Average(p => p.kpi_other_promo);\n}\nreturn 0;\n\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "b697d4ca-bdef-42ca-ac77-9130c9f84ce9", "Name": "kpi_PromoPriceWithHealthTAX_HU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\n\n// Перевіряємо, чи кількість продуктів не дорівнює нулю\nif (kpi_Promo_price_proposal_manually_HU != 0)\n{\n    result = kpi_Promo_price_proposal_manually_HU + 10;\n}\nelse\n{\n    result = 0;\n}\n// Округлюємо result до цілого і приводимо до типу int\nreturn (int)Math.Round(result);", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 1}, {"Id": "47160d6a-218b-4449-8af3-91da435455c0", "Name": "kpi_Baseline_Product_calc", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "var    Number_Shipmentdays_of_CA=((Activity.ShipmentEndDate - Activity.ShipmentStartDate).Days +1);\nif (kpi_Baseline_ProductRead != null)\n{\n    return kpi_Baseline_ProductRead * (Number_Shipmentdays_of_CA);\n}\nelse\n{\n    return 0; // Значення за замовчуванням\n}", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "ba41d07f-4c27-477f-bc11-92fcbca6c4f1", "Name": "kpi_GCM_total_BW", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return kpi_GCM_total_promo - kpi_GCM_total_baseline\n ;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "e32a0b26-2c89-4ed1-9463-93b6b3914c7d", "Name": "kpi_regular_baseline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "  if (Products.Count() != 0 ){\nreturn\tProducts.Average(p => p.kpi_Listing_customer_price_automatically);\n}\nelse{\nreturn 0;\n}", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "e9ae7c1e-347b-4291-b8a5-9a0ecde2ea91", "Name": "kpi_sell_In_manually", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 3, "HierarchyAggregationType": 1, "DistributionKPIId": "b45c13b3-41c1-4737-83c8-a9ba29a4d574", "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "491ab7fc-6794-480f-a18d-9a1f730b6e8f", "Name": "kpi_Baseline_Product_Pcs", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": " decimal result = 0; // Ініціалізуємо змінну result зі значенням 0\n// Перевіряємо, чи кількість продуктів не дорівнює нулю\n if (Activity.Products.Count() != 0)\n {\nresult = kpi_Baseline_Product_calc / 1000;\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "12e70200-28fc-49cf-9c74-9a4f261265dc", "Name": "kpi_Min_Budgeted_Promo_price", "Type": 0, "ReadKPIConditionMetadataId": "8e9b1397-117e-4227-b8d7-71e9bcd1dff8", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 1.0, "ReadKPIAggregationType": 2.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "8be28b7e-0cef-4c84-8aa1-9a767d95a6cc", "Name": "kpi_highlightGreenPromotionalTypeGuideline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "if (Activity.cf_UnsavedNew is true)\n{\n    return false;\n}\n\nif (kpi_ExistingProduct == false)\n{\n    return false;\n}\nreturn kpi_PromotionalTypeCheckGuideline;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "1ca862eb-4ab1-49bd-97fe-9b15e4f9d1ae", "Name": "kpi_InOutOfGuidlineAgregate", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "return 0;\n\n//if (Activity.cf_UnsavedNew is true)\n//{\n//    return 1; // Повертаємо 1, якщо Activity.cf_UnsavedNew дорівнює true\n//}\n\n// Перевіряємо KPI для кожного продукту\n//if (!kpi_mostFrequentPromoShelfPriceGuideline ||  \n//    !kpi_PromotionalTypeCheckGuideline ||  \n//    !kpi_CombinationToAvoidInOutOfGuideline) \n//{\n//    return 1; // Якщо хоча б один KPI дорівнює false, повертаємо 1\n//}\n\n//return 0; // Якщо всі KPI дорівнюють true, повертаємо 0\n\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 1}, {"Id": "2dafea2a-be78-4eb3-ac0d-9b19a9512570", "Name": "kpi_GCM_price_shelf_BW", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return\nkpi_GCM_price_shelf_promo - kpi_GCM_price_shelf_baseline ;\n//kpi_Min_Budgeted_Promo_price_total - kpi_regular_baseline;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "6db2da1c-d38d-4485-81c5-9b90d3250a5b", "Name": "kpi_GCM_promo_price_index", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result;\n\nif ((decimal)kpi_GCM_promo_price_baseline != 0)\n{\n    result =  ((decimal)kpi_GCM_promo_price_promo / (decimal)kpi_GCM_promo_price_baseline) *100;\n}\nelse\n{\n    result = 0; // або будь-яке інше значення, яке відповідає логіці вашої програми\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "bcd8855a-87d1-412a-8fa8-9d01def3a2c9", "Name": "kpi_ActualBudget", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "7eca997c-25fd-414e-bd08-9d27f3891b51", "Name": "kpi_rebateBaseline", "Type": 0, "ReadKPIConditionMetadataId": "f3b5d4b3-9c07-4dfb-8573-8874063f8164", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 2.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "883c0b74-685b-4062-85d2-9d4076a540af", "Name": "kpi_Gross_Margin", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_GrossMarginSKU);\n}\nreturn result;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "612cb247-6cb9-48c7-97d1-9d761e77be8b", "Name": "kpi_VariablePromoSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\n    result = kpi_Promo_price_proposal_manually * (kpi_rebatePromoBonus/100)*kpi_PromoVolumePlanSKU;\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "5de2289d-917b-4b3e-b1b0-9f0f097a948c", "Name": "kpi_ACT_GCM_total_BW", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return kpi_ACT_GCM_total_promo - kpi_GCM_total_baseline;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "1a6a1bad-ab3b-44bc-83a3-9f3bf172f661", "Name": "kpi_Net_Revenue_L9", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nvar grP = Activity.Products\n    .GroupBy(p => p.Product.ProductInfo.CustomFields.FirstOrDefault(cf => cf.Name == \"cf_Product_Planning_Base_Label\")?.Value?.ToString())\n    .Select(g => new \n    {\n        g.Key,\n        BaselineSum = g.Sum(p => p.kpi_Baseline_Product_calc),\n        PromoUpliftSum = g.Sum(p => p.kpi_Promo_Uplift_KAM),\n        MinBPPAvg = g.Average(p => p.kpi_Min_Budgeted_Promo_price),\n        RebatePromoBonusAvg = g.Average(p => p.kpi_rebatePromoBonus),\n        FixedInvestmentSum = g.Sum(p => p.kpi_FixedInvestment_KAM)\n    })\n    .ToList();\nvar groupData = grP.FirstOrDefault(g => g.Key == Product.ProductInfo.CustomFields\n    .FirstOrDefault(cf => cf.Name == \"cf_Product_Planning_Base_Label\")?.Value?.ToString());\nif (groupData != null)\n    result = (groupData.BaselineSum + groupData.PromoUpliftSum) * \n             (groupData.MinBPPAvg * (1 - groupData.RebatePromoBonusAvg / 100)) - \n             groupData.FixedInvestmentSum;\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "b0bfc276-2c70-4823-8176-9f6dd49c8a2c", "Name": "kpi_baseline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "  if (Products.Count() != 0 ){\nreturn\tProducts.Sum(p => p.kpi_Baseline_Product_calc);\n}\nelse{\nreturn 0;\n}", "Description": "Plan & Fact: auto-calculation is described in Chapter 6. Overview of the Baseline\t\n", "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "a8058eed-4f11-4e7f-a813-9f7184116148", "Name": "kpi_frcPromoVolumeShort", "Type": 0, "ReadKPIConditionMetadataId": "b7a89f8d-24c9-4fdf-858e-9f99eb8b42be", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "38c1a450-1c18-4d7f-95d2-a46c9544bb83", "Name": "kpi_kpi_Promo_Uplift_KAM_1000", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": " decimal result = 0; // Ініціалізуємо змінну result зі значенням 0\n// Перевіряємо, чи кількість продуктів не дорівнює нулю\n if (Activity.Products.Count() != 0)\n {\nresult = kpi_Promo_Uplift_KAM / 1000;\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "44664f1a-f8b6-40f7-a0eb-a4c9fd1e0457", "Name": "kpi_DisplayCombinationToAvoidInOutOfGuideline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "return 0;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "8f18f1f0-e620-4a22-b58a-a4ee510240f5", "Name": "kpi_volume_after_promo", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "53cf61bd-48c8-4ade-b2eb-a5df8e35b183", "Name": "kpi_Pile1", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "3633f9a0-ea25-4187-bd37-a6f252535095", "Name": "kpi_Better_or_Worse", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return kpi_promo_total_volume_plan - kpi_baseline ;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "90528ece-85a8-4b09-8f3e-a7f303957d85", "Name": "kpi_volume_pre_promo", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "b45c13b3-41c1-4737-83c8-a9ba29a4d574", "Name": "kpi_Baseline_Product_Intermediate", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nvar groupedProductsWithZeroSum = Activity.Products\n    .Where(p => p.kpi_Baseline_Product != null)\n    .GroupBy(p => p.Product.ProductInfo.CustomFields.FirstOrDefault(cf => cf.Name == \"cf_Product_Planning_Base_Label\")?.Value?.ToString())\n    .Select(group => new \n    {\n        GroupKey = group.Key,        Products = group.ToList(),\n        SumBaselineProduct = group.Sum(p => p.kpi_Baseline_Product)\n    })\n    .Where(group => group.SumBaselineProduct == 0)\n    .Select(group => group.GroupKey) // Зберігаємо лише ключі груп\n    .ToList();\n\nvar productLabel = Product.ProductInfo.CustomFields.FirstOrDefault(cf => cf.Name == \"cf_Product_Planning_Base_Label\")?.Value?.ToString();\n\n    if (groupedProductsWithZeroSum.Contains(productLabel))\n    {\n        result = 1;\n    }\n    else\n    {\n        result = kpi_Baseline_Product;\n    }\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "8b977a54-806e-4179-8e4e-a9e804538c18", "Name": "kpi_highlightCombinationToAvoidInOutOfGuideline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "\nif (Activity.cf_UnsavedNew is true)\n{\n    return false;\n}\n\nif (kpi_ExistingProduct is false)\n{\n    return false;\n}\n\nreturn !kpi_CombinationToAvoidInOutOfGuideline;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "7ae4c513-8358-496b-944f-aa6d10d910c8", "Name": "kpi_VBB", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "//return kpi_Promo_Uplift_KAM ;\nreturn 1;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "8769b582-2f1e-4997-9a19-aaab13156b61", "Name": "kpi_GCM_total_shelf_index", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result;\n\nif ((decimal)kpi_GCM_total_shelf_baseline != 0)\n{\n    result =  ((decimal)kpi_GCM_total_shelf_promo  / (decimal)kpi_GCM_total_shelf_baseline)*100-100;\n}\nelse\n{\n    result = 0; // або будь-яке інше значення, яке відповідає логіці вашої програми\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "0b5716e8-21ca-4039-aa59-aac9e211ae05", "Name": "kpi_ActSalesMarginSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nresult = (decimal) (kpi_ActNetRevenueSKU-kpi_cogs_promo*kpi_sell_out_manually);\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "d80464cb-4a1c-48fb-9880-ab23bbb7f079", "Name": "kpi_SKUHistoricalDataForL9", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "8cdd99b8-6acc-4237-b707-ac58b31a6edd", "Name": "kpi_PromotionalTypeCheckGuideline", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 2, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "27870d3e-51b7-4d17-aecf-ac7c57160e77", "Name": "kpi_SMM_SFA_MM_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return    kpi_SFA_MM_promo *(1-kpi_A_kpi_rebatePromoBonus/100) -kpi_A_cogs_promo ;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "6a6221f2-c350-4178-929b-ad838667de34", "Name": "kpi_Net_Revenue", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_NetRevenueSKU);\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "18b090d5-9e86-4790-8dfd-ad99b563fa6b", "Name": "kpi_UpliftCalc_Mechanic", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "var    Number_Shipmentdays_of_CA=((Activity.ShipmentEndDate - Activity.ShipmentStartDate).Days +1);\n\n// Створюємо словник для зберігання значень\nDictionary<Guid, decimal> kpiValues = new Dictionary<Guid, decimal>\n{\n    { new Guid(\"47C747D8-BA01-432A-A320-B6F7DD7D0633\"), kpi_UpliftCalc_Leaflet },\n    { new Guid(\"78041807-4A08-4C31-884E-FE3BDCFDEA45\"), kpi_UpliftCalc_SlntPromo },\n    { new Guid(\"04563662-0556-441F-8E80-A74E595C7097\"), kpi_UpliftCalc_SecPlace },\n    { new Guid(\"3E66F51F-C580-4B7F-8176-8AD2B4B246A9\"), kpi_UpliftCalc_EDLP }\n};\n\n// Шукаємо значення у словнику\nif (kpiValues.TryGetValue(Activity.MechanicId, out decimal kpiValue))\n{\n    return kpiValue * (Number_Shipmentdays_of_CA);\n}\nelse\n{\n    return 0; // Значення за замовчуванням\n}\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "b867b5c4-7659-4af4-b2e8-aecb035b5ab2", "Name": "kpi_factNumberOfPromoRead", "Type": 0, "ReadKPIConditionMetadataId": "080571f2-5016-457a-838e-c714bfb739d0", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "85af2e91-fb7e-428f-9e77-b2a3a3a3facb", "Name": "kpi_Baseline_Product_1000", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": " decimal result = 0; // Ініціалізуємо змінну result зі значенням 0\n// Перевіряємо, чи кількість продуктів не дорівнює нулю\n if (Activity.Products.Count() != 0)\n {\nresult = kpi_Baseline_Product_calc / 1000;\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "43ee17c3-56c6-4509-a2d4-b3de4d4cf833", "Name": "kpi_FrontRetailMarginBtl", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nif (kpi_ShelfDummy == 0)\n{\n    result = 1;\n}\nelse\n{\n    result = 1 - (decimal)kpi_Promo_price_proposal_manually / kpi_ShelfDummy;\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "390275af-770a-47ad-baf7-b3f773fea067", "Name": "kpi_A_smm_baseline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return\nkpi_Min_Budgeted_Promo_price_total *(1-kpi_A_rebateBaseline/100) - kpi_A_cogs_baseline\n;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "b7de5247-1f0b-4265-b48f-b4184a62cb92", "Name": "kpi_ActVolumeBWSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nresult = (decimal) (kpi_sell_out_manually - kpi_Baseline_Product_calc);\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "abc4773a-5d07-40b1-b3ac-b4d99f073bb7", "Name": "kpi_Promo_price_proposal_manually_HU", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 2, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 1}, {"Id": "51fd25bf-d0ca-437d-bcc5-b596deb9c58d", "Name": "kpi_Forward_Buy", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": "var isGroup1 = ClientDetails.CustomFields.FirstOrDefault(cf => cf.Name == \"cf_IsGroup1\")?.Value;\nvar period = ObjectSpace.GetObjectByKey<Period>(RelatedPeriodId);\n \nif (period.EndDate.Date < DateTime.Now.Date)\n{\n    var diff = kpi_frcSKUSalesAsShare - kpi_BaselineVBB - kpi_ForecastPromoVolume;\n    //return diff < 0 ? diff : 0;\n    return diff;\n}\nelse if (isGroup1 != null && (bool)isGroup1 == true && period.StartDate.Date > DateTime.Now.AddMonths(2).Date)\n{\n    return 0;\n}\nelse\n{\n    return 0;\n}", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "04624e9f-426b-4969-91c7-b6edd57eba30", "Name": "kpi_disableKpiEditing", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "if (Activity.cf_DisableKpiPromo is true)\n{\n    return true;\n}\nelse\n{\n    return false;\n}", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 4, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "80fdd0c8-cd25-4694-af2d-b7efbde7029c", "Name": "kpi_GCMShelfPromoSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\n    result = kpi_PromoVolumePlanSKU  * ((kpi_Promo_price_proposal_manually - (kpi_Promo_price_proposal_manually * kpi_rebatePromoBonus / 100) - kpi_cogs_promo) - kpi_other_promo - kpi_transport_promo - kpi_WHS_promo) - kpi_FixedInvestment_KAM;\nreturn result; ", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "53ab9ca5-34da-49e6-9998-ba3c3e54ec67", "Name": "kpi_Baseline_ProductRead", "Type": 0, "ReadKPIConditionMetadataId": "ccebb45d-846b-4e46-85c3-80c4c2722236", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 4.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "a2c2bb8f-7aaa-4987-8876-ba7011b2dc61", "Name": "kpi_FixedInvestment_Intermediate", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "f98d2319-a179-4bad-ae0d-baa0075432b0", "Name": "kpi_UpliftCalc_SlntPromo", "Type": 0, "ReadKPIConditionMetadataId": "039463b3-2e17-4670-889f-66cb875e5628", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 4.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "588add38-617e-4324-8c2c-bd283c058b43", "Name": "kpi_highlightGreenCombinationToAvoidGuideline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "if (Activity.cf_UnsavedNew is true)\n{\n    return false;\n}\n\nif (kpi_ExistingProduct is false)\n{\n    return false;\n}\nreturn kpi_CombinationToAvoidInOutOfGuideline;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "9f4e3bf2-5d19-459a-8f7e-bdef4307a771", "Name": "kpi_A_transport_baseline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "\n  if (Products.Count()>0){\nreturn\tProducts.Average(p => p.kpi_transport_baseline);\n}\nreturn 0;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "e995a3ea-0ea9-46de-9bc0-c09a10f23751", "Name": "kpi_CombinationToAvoidInOutOfGuideline", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 2, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "c996c439-38a7-432c-b7bb-c107dc70b281", "Name": "kpi_cogs_promo", "Type": 0, "ReadKPIConditionMetadataId": "a2da9074-b711-4cb1-b425-bfb52fe46200", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 2.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "b113aecb-9530-4e35-a1f9-c2743b785508", "Name": "kpi_rebatePromoBonus", "Type": 0, "ReadKPIConditionMetadataId": "41074e05-d959-4878-b713-4e9c18ab3edd", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 2.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "5dcb5331-5bb3-409d-86eb-c3639b7911aa", "Name": "kpi_DisplayPromotionalTypeCheckGuideline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "return 0;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "4d311e0e-1ccb-4cc8-a24d-c4b29cb875ed", "Name": "kpi_A_cogs_baseline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "  if (Products.Count()>0){\nreturn\tProducts.Average(p => p.kpi_cogs_baseline);\n}\nreturn 0;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "f50d3cb0-0bdc-4b15-af0d-c70728452c88", "Name": "kpi_Promo_Uplift_KAM", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": "a4f41038-7d2e-442d-8dc1-7a8a6a6a11ed", "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 3, "HierarchyAggregationType": 1, "DistributionKPIId": "e0415bb7-bca1-48b0-898f-883aa9648eda", "DisaggregateMonthly": true, "RelevantPeriodStart": "StartDate", "RelevantPeriodEnd": "EndDate", "DataType": 0}, {"Id": "13660708-ffbc-4d28-8b8c-caeb7f4e8a32", "Name": "kpi_GCM_price_shelf_baseline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return\nkpi_SMM_SFA_MM_baseline-kpi_A_other_promo-kpi_A_transport_promo-kpi_A_WHS_promo ;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "32cb9855-2ed4-4c75-9d07-cbdb3b23828c", "Name": "kpi_highlightMinBudgetedPromoprice", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "if (kpi_Min_Budgeted_Promo_price == 0)\n{\n    return true;\n}\n\nreturn false;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "16f52640-b533-4851-844a-cc1ef4a5206b", "Name": "kpi_other_promo", "Type": 0, "ReadKPIConditionMetadataId": "b12edb25-d8cb-4eeb-9aac-e2d00da8c4c6", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 2.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "ad8443ec-9e0a-44fe-96a8-cc3cc656ee59", "Name": "kpi_kpi_fixed_investment", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\n\nvar groupedProductsWithZeroSum = Activity.Products\n    .GroupBy(p => p.Product.ProductInfo.CustomFields.FirstOrDefault(cf => cf.Name == \"cf_Product_Planning_Base_Label\")?.Value?.ToString())\n    .Select(group => new\n    {\n        GroupKey = group.Key,\n        Products = group.ToList(),\n        Sum = group.Sum(p => p.kpi_Baseline_Product_calc + p.kpi_Promo_Uplift_KAM) // Обчислюємо суму\n    })\n    .Where(group => group.Sum == 0) // Залишаємо групи з сумою 0\n    .Select(group => group.GroupKey)\n    .ToList();\n\nvar productLabel = Product.ProductInfo.CustomFields\n    .FirstOrDefault(cf => cf.Name == \"cf_Product_Planning_Base_Label\")?.Value?.ToString();\n\nresult = groupedProductsWithZeroSum.Contains(productLabel) \n    ? 1 \n    : (kpi_Baseline_Product_calc + kpi_Promo_Uplift_KAM != 0 \n        ? kpi_Baseline_Product_calc + kpi_Promo_Uplift_KAM \n        : kpi_FixedInvestment_KAM);\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "1efa9810-f39c-4472-9565-cf4b3dcc669e", "Name": "kpi_A_WHS_baseline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "\n  if (Products.Count()>0){\nreturn\tProducts.Average(p => p.kpi_WHS_baseline);\n}\nreturn 0;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "a8f00a79-5fc9-4cdd-bfdd-d31953b5b029", "Name": "kpi_ACT_GCM_total_shelf_BW", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return \nkpi_ACT_GCM_total_shelf_promo -kpi_GCM_total_shelf_baseline ;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "f294ed6c-5928-40a8-ad9d-d49d849592da", "Name": "kpi_Pile2", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 1}, {"Id": "1eeacde4-8f85-4062-b394-d5a78efcfc5c", "Name": "kpi_ExistingProduct", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": "Технічний KPI для визначення що продукт щойно доданий до активності і активність ще не засейвлена. По замовчуванню False", "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "4ba5c7bb-8e47-415a-9094-d63b2fac0952", "Name": "kpi_ACT_GCM_total_index", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result;\n\nif ((decimal)kpi_GCM_total_baseline != 0)\n{\n    result =   ((decimal)kpi_ACT_GCM_total_promo / (decimal)kpi_GCM_total_baseline)*100;\n}\nelse\n{\n    result = 0; // або будь-яке інше значення, яке відповідає логіці вашої програми\n}\n\nreturn result;", "Description": " ", "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "6e560050-41bb-4ed6-98ca-d989bb8421e6", "Name": "kpi_highlightListingCustomerPriceAutomatically", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "if (kpi_Listing_customer_price_automatically == 0)\n{\n    return true;\n}\n\nreturn false;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "2aa4ef11-fa82-492c-8c20-d9c3ed9a3efe", "Name": "kpi_GCM_total_index", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "\ndecimal result = 0;\n\n// Перевіряємо, чи знаменник не дорівнює 0\nif (kpi_GCM_total_baseline != 0)\n{\n    result = ((kpi_GCM_total_promo / kpi_GCM_total_baseline) * 100) - 100;\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "07fe61c3-2579-4c84-82b5-d9d92fe7ccf9", "Name": "kpi_ASmmBaselineSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\n    result = kpi_Listing_customer_price_automatically - (kpi_Listing_customer_price_automatically*kpi_rebatePromoBonus/100) - kpi_cogs_promo;\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "b482e25b-a47b-4cad-8e00-dafb295bb6bf", "Name": "kpi_GrowthRate_tech", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "e3417346-6e71-4cfa-b95d-db1b23ff2be2", "Name": "kpi_GCMPromoSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\n\nresult = kpi_sell_out_manually * \n         (\n            (\n                kpi_Promo_price_proposal_manually -\n                (kpi_Promo_price_proposal_manually * kpi_rebatePromoBonus / 100) -\n                kpi_cogs_promo\n            ) - \n            kpi_other_promo - \n            kpi_transport_promo - \n            kpi_WHS_promo\n         ) - \n         kpi_FixedInvestment_KAM;\n\nreturn result;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "422ed0c3-a5b6-49b2-b88c-db36ce759e38", "Name": "kpi_GCM_total_baseline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_GCMBaselineSKU);\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "00f23959-0053-4425-a5d2-dcf07130175a", "Name": "kpi_GCM_price_shelf_index", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result;\n\nif ((decimal)kpi_GCM_price_shelf_baseline > 0)\n{\n    result =   ((decimal)kpi_GCM_price_shelf_promo / (decimal)kpi_GCM_price_shelf_baseline )*100;\n}\nelse\n{\n    result = 0; // або будь-яке інше значення, яке відповідає логіці вашої програми\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "6d2c2d36-5daa-48e2-86c1-ddaaef4862cc", "Name": "kpi_A_smm_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return \nkpi_promotional_promo *(1-kpi_A_kpi_rebatePromoBonus/100) -kpi_A_cogs_promo\n;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "b9f986d9-d4d2-49b7-84e6-dedeaeec8545", "Name": "kpi_Promo_Type_GuideKPI", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 2, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 3}, {"Id": "4c6d1180-5336-4e2c-800c-e0b3751a1733", "Name": "kpi_Listing_customer_price_automatically", "Type": 0, "ReadKPIConditionMetadataId": "1b01f71d-257d-40a8-a38a-04f81c5ccff7", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 1.0, "ReadKPIAggregationType": 2.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 2, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "c4e316f2-737d-4fc7-a155-e1792ec32218", "Name": "kpi_TotalPlanVolumePromotion", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "return\tkpi_Promo_Uplift_KAM + kpi_Baseline_Product_calc;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "c2660364-49e9-4aab-a141-e1798d8e763c", "Name": "kpi_ActNetRevenueSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nresult = (decimal) (kpi_Promo_price_proposal_manually*kpi_sell_out_manually*(1-kpi_rebatePromoBonus/100)-kpi_FixedInvestment_KAM);\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "100e8819-9668-4044-bacc-e2ae8744734d", "Name": "kpi_Copy_Bool", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 2, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "764ff6cc-decb-42c2-ab94-e650bba15416", "Name": "kpi_sell_out_calc", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": "a4f41038-7d2e-442d-8dc1-7a8a6a6a11ed", "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nif (kpi_sell_out_manually != 0 && kpi_FiFOdaysFoActSales_SelOut > 0)\n{\n    result = kpi_sell_out_manually - (kpi_Baseline_ProductRead*kpi_FiFOdaysFoActSales_SelOut);\n}\nelse if (kpi_FiFOdaysFoActSales_SelIn > 0)\n{\n    result = kpi_sell_In_manually - (kpi_Baseline_ProductRead*kpi_FiFOdaysFoActSales_SelIn);\n}\nelse \n{\n    result = 0;\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": true, "RelevantPeriodStart": "ShipmentStartDate", "RelevantPeriodEnd": "ShipmentEndDate", "DataType": 0}, {"Id": "9e21fe1a-4d87-49a6-a91a-e89ffe98934e", "Name": "kpi_UnfoldedBaseline", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "7550f4e0-eb14-4e19-8330-e9379733313e", "Name": "kpi_highlightMostFrequentPromoShelfPriceGuideline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "if (Activity.cf_UnsavedNew is true)\n{\n    return false;\n}\n\nif (kpi_ExistingProduct == false)\n{\n    return false;\n}\nreturn !kpi_mostFrequentPromoShelfPriceGuideline;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "1447c10f-e2ba-4ddc-8aa0-ea23f33baaa2", "Name": "kpi_GrossMarginSKU", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "decimal result = 0;\nresult = (decimal) (kpi_SalesMarginSKU - (kpi_Baseline_Product_calc + kpi_Promo_Uplift_KAM) * (kpi_transport_promo + kpi_other_promo + kpi_WHS_promo));\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "248e88cb-f99e-4ffc-9ffa-eaf80dd4e329", "Name": "kpi_NumberOfPromotionsL9", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 2, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "e1c69120-aa1d-43c7-a101-ed981e27fa73", "Name": "kpi_transport_baseline", "Type": 0, "ReadKPIConditionMetadataId": "621c44ab-6958-4c0a-8d6d-fd17428e34b5", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": 0.0, "ReadKPIAggregationType": 2.0, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "84b835b0-8b35-46b1-bf6e-edbaddf08631", "Name": "kpi_highlightCombinationToRecommendGuideline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "if (Activity.cf_UnsavedNew is true)\n{\n    return false;\n}\n\nif (kpi_ExistingProduct == false)\n{\n    return false;\n}\nreturn !kpi_CombinationToRecommendInOutOfGuideline;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "7c5be727-9d29-4509-92e5-edfbfd02e867", "Name": "kpi_frcSKUSalesAsShare", "Type": 0, "ReadKPIConditionMetadataId": "9d98bd8f-21e3-494b-ba15-ce3a30866c47", "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "b74e39b5-263e-4dff-9073-ee74a9395497", "Name": "kpi_mostFrequentPromoShelfPriceGuideline", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 2, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "3acc0e80-058c-4029-b92f-f051c81353ce", "Name": "kpi_GCM_total_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result = 0;\nif (Products.Any()) // Перевіряємо, чи є продукти\n{\n    result = Products.Sum(p => p.kpi_GCMPromoSKU);\n}\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "a374d13e-fa75-4049-bf40-f0c00926a868", "Name": "kpi_shelfPriceVisualState", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "bool isDisabled = Activity.cf_DisableKpiPromo == true;\nbool isHighlighted = false;\n\nif (Activity.cf_UnsavedNew != true && kpi_ExistingProduct == true)\n{\n    isHighlighted = !kpi_mostFrequentPromoShelfPriceGuideline;\n}\n\nreturn isDisabled && isHighlighted;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "4f5f0a72-4185-4e5f-9374-f19f059c2962", "Name": "kpi_Highlight_Zero_And_DisabledPProposalManually", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "bool isZero = kpi_Promo_price_proposal_manually == 0;\nbool isDisabled = Activity.cf_DisableKpiPromo == true;\n\nreturn isZero && isDisabled;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 3, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 2}, {"Id": "a7fb94c2-9aac-45b5-98ec-f47b9521ae88", "Name": "kpi_SFA_MM_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "  if (Products.Count() != 0 ){\nreturn\tProducts.Average(p => p.kpi_Min_Budgeted_Promo_price\n);\n\n}\nelse{\nreturn 0;\n}\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "8b9c913c-0a0b-4357-ab8b-f5703d7c4a4f", "Name": "kpi_A_WHS_promo", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "  if (Products.Count()>0){\nreturn\tProducts.Average(p => p.kpi_WHS_promo);\n}\nreturn 0;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "65ae949d-1264-42dd-a4ec-f68f8eace7e0", "Name": "kpi_Fixed_Investment_header", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "d9eea63b-5603-4e83-a2c7-f72e918b865e", "Name": "kpi_Planned_Volume", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "c55f7f77-eb98-4571-92d9-fa42b35341b9", "Name": "kpi_Reach", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "676495b2-c283-4a51-8169-fa84e6474f46", "Name": "kpi_ROPI_price_shelf_BW", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result;\n\nif ((decimal)kpi_investment_total_promo  > 0)\n{\nresult =  ((decimal)kpi_GCM_total_shelf_BW /(decimal)kpi_investment_total_promo )*100;\n}\nelse\n{\n    result = 0;\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "13313bf6-ccb3-443a-8f8d-fa98b0a348e8", "Name": "kpi_A_other_baseline", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "  if (Products.Count()>0){\nreturn\tProducts.Average(p => p.kpi_other_baseline);\n}\nreturn 0;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "1d42b329-0b98-4cab-8906-faac59012621", "Name": "kpi_SentToApprove", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "if (!Products.Any())\n{\n    return 0;\n}\nbool verification = Products.Any(p => p.kpi_Promo_price_proposal_manually > p.kpi_Min_Budgeted_Promo_price);\n\nreturn verification ? 1 : 0;\n", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "7504bedd-dbfe-47e2-9a4e-faad2b393424", "Name": "kpi_SFA_MM_index", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "decimal result;\n\nif ((decimal)kpi_regular_baseline > 0)\n{\n    result =    (decimal)kpi_SFA_MM_promo/(decimal)kpi_regular_baseline;\n}\nelse\n{\n    result = 0; // або будь-яке інше значення, яке відповідає логіці вашої програми\n}\n\nreturn result;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "67109be2-dda8-4df6-8bff-fc576c6419ca", "Name": "kpi_Promo_Volume_Past", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": "ccc3f49f-1cb8-4ff2-bf74-cc5b3a8fef5c", "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 1, "CalculationKPIFormula": "return new[] {\"🔒 Evaluated / Closed\", \"🏁 Ended\"}.Contains(Activity.State.Name.ToString()) ? kpi_sell_out_calc : 0;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": true, "RelevantPeriodStart": "ShipmentStartDate", "RelevantPeriodEnd": "ShipmentEndDate", "DataType": 0}, {"Id": "02a71d42-1054-4bb5-a080-fe3ccbf7ef7f", "Name": "kpi_GCM_total_shelf_BW", "Type": 2, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 0, "CalculationKPIFormula": "return kpi_GCM_total_shelf_promo -kpi_GCM_total_shelf_baseline ;", "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 0, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}, {"Id": "ac380a92-2587-456b-9300-ff5af7566e11", "Name": "kpi_NumberOfPromotionsVBB", "Type": 1, "ReadKPIConditionMetadataId": null, "ReadKPIForecastMetadataId": null, "ReadKPITimeFrame": null, "ReadKPIAggregationType": null, "BusinessObjectType": 2, "CalculationKPIFormula": null, "Description": null, "HierarchyDistributionType": 0, "HierarchyAggregationType": 1, "DistributionKPIId": null, "DisaggregateMonthly": false, "RelevantPeriodStart": null, "RelevantPeriodEnd": null, "DataType": 0}]}